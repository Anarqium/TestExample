html
<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firefox Startseite</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-color: #f5f5f7;
            --accent-color: #ff9500;
            --accent-gradient: linear-gradient(145deg, #ff9500, #e66000);
            --card-bg: rgba(40, 40, 40, 0.7);
            --card-border: rgba(80, 80, 80, 0.3);
            --nav-bg: rgba(30, 30, 30, 0.9);
            --input-bg: rgba(255, 255, 255, 0.1);
            --item-bg: rgba(255,255,255,0.05);
            --divider-bg: rgba(255, 255, 255, 0.1);
            --card-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
            --card-hover-shadow: 0 15px 30px rgba(0, 0, 0, 0.25);
            --card-radius: 16px;
            --transition-speed: 0.3s;
            --accent-color-rgb: 255, 149, 0; /* RGB version of accent color for transparency */
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            background: linear-gradient(145deg, #121212, #202020);
            padding-top: 20px;
            padding-bottom: 80px;
            transition: background 0.5s ease;
            /* Added for custom background images */
            background-size: cover;
            background-position: center center;
            background-attachment: fixed;
        }
        
        /* Bottom Navigation Bar */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 70px;
            background-color: var(--nav-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-around;
            z-index: 1000;
            box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.2);
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            transition: all var(--transition-speed) ease;
        }
        
        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-color);
            opacity: 0.7;
            transition: all var(--transition-speed);
            text-decoration: none;
            padding: 10px;
            border-radius: 12px;
            width: 65px;
        }
        
        .bottom-nav-item:hover, .bottom-nav-item.active {
            opacity: 1;
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateY(-5px);
        }
        
        .bottom-nav-item i {
            font-size: 24px;
            margin-bottom: 4px;
        }
        
        .bottom-nav-item span {
            font-size: 11px;
            text-align: center;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
            padding: 20px;
            flex: 1;
        }
        
        /* Logo and header */
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            position: relative;
        }
        
        .logo {
            height: 50px;
            transition: transform 0.5s ease;
            position: relative;
            z-index: 2;
        }
        
        .logo:hover {
            transform: rotate(15deg) scale(1.1);
        }
        
        .logo-glow {
            position: absolute;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 149, 0, 0.3) 0%, rgba(255, 149, 0, 0) 70%);
            animation: pulse 3s infinite alternate;
            z-index: 1;
        }
        
        @keyframes pulse {
            0% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            100% {
                transform: scale(1.2);
                opacity: 0.8;
            }
        }
        
        /* Enhanced Search container */
        .search-container {
            margin: 30px auto;
            width: 100%;
            max-width: 580px;
            position: relative;
            transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
        }
        
        .search-container:hover {
            transform: translateY(-3px);
        }
        
        .search-form {
            display: flex;
            width: 100%;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 16px 20px 16px 50px;
            font-size: 16px;
            border: none;
            border-radius: 20px;
            background-color: var(--input-bg);
            color: var(--text-color);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2), inset 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all var(--transition-speed) ease;
        }
        
        .search-input:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.15);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2), inset 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-color);
            font-size: 22px;
            opacity: 0.7;
            z-index: 10;
        }
        
        .voice-search {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-color);
            font-size: 22px;
            opacity: 0.7;
            background: none;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            z-index: 10;
        }
        
        .voice-search:hover {
            opacity: 1;
            transform: translateY(-50%) scale(1.1);
        }
        
        .speech-recognition-active {
            animation: pulse-recording 1.5s infinite;
        }
        
        @keyframes pulse-recording {
            0% { color: var(--text-color); }
            50% { color: #f44336; }
            100% { color: var(--text-color); }
        }
        
        /* Enhanced Shortcuts */
        .shortcuts-heading {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 0 auto 20px;
            max-width: 800px;
            padding: 0 15px;
        }
        
        .shortcuts-title {
            font-size: 18px;
            font-weight: 500;
            opacity: 0.8;
        }
        
        .add-shortcut-quick {
            background: none;
            border: none;
            color: var(--accent-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .add-shortcut-quick:hover {
            transform: scale(1.05);
        }
        
        .shortcuts {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            gap: 20px;
            margin: 10px auto 40px;
            max-width: 800px;
            justify-content: center;
            padding: 0 15px;
        }
        
        .shortcut {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 90px;
            height: 90px;
            border-radius: var(--card-radius);
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            text-decoration: none;
            color: var(--text-color);
            box-shadow: var(--card-shadow);
            position: relative;
            overflow: hidden;
        }
        
        .shortcut:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-hover-shadow);
            background-color: rgba(60, 60, 60, 0.7);
            border-color: rgba(var(--accent-color), 0.3);
        }
        
        .shortcut::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--accent-gradient);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }
        
        .shortcut:hover::before {
            transform: scaleX(1);
        }
        
        .shortcut img {
            width: 36px;
            height: 36px;
            margin-bottom: 10px;
            border-radius: 10px;
            transition: transform 0.3s ease;
            filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
        }
        
        .shortcut:hover img {
            transform: scale(1.1);
        }
        
        .shortcut span {
            font-size: 12px;
            max-width: 90%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .shortcut .remove-shortcut {
            position: absolute;
            top: 5px;
            right: 5px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 10;
        }
        
        .shortcut:hover .remove-shortcut {
            opacity: 1;
        }
        
        .shortcut .remove-shortcut:hover {
            background-color: #f44336;
            transform: scale(1.1);
        }
        
        /* Enhanced Widgets */
        .widgets-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .widgets-row {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .widget {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--card-radius);
            padding: 20px;
            width: 100%;
            max-width: 380px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: var(--card-shadow);
            transition: all var(--transition-speed) ease;
            position: relative;
            overflow: hidden;
        }
        
        .widget::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: var(--accent-gradient);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }
        
        .widget:hover::before {
            transform: scaleX(1);
        }
        
        .widget:hover {
            transform: translateY(-5px);
            box-shadow: var(--card-hover-shadow);
        }
        
        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .widget-title {
            font-size: 16px;
            font-weight: 500;
            color: var(--text-color);
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .widget-title i {
            color: var(--accent-color);
        }
        
        .widget-actions {
            display: flex;
            gap: 10px;
        }
        
        .widget-action {
            background: none;
            border: none;
            color: var(--text-color);
            opacity: 0.6;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .widget-action:hover {
            opacity: 1;
            transform: scale(1.1);
        }
        
        /* Weather Widget */
        .weather-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .weather-temp {
            font-size: 42px;
            font-weight: 300;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .weather-desc {
            font-size: 14px;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .weather-details {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        
        .weather-detail {
            text-align: center;
            font-size: 12px;
            opacity: 0.8;
            flex-basis: 33%;
            margin-bottom: 15px;
            transition: transform 0.2s;
        }
        
        .weather-detail:hover {
            transform: scale(1.05);
            opacity: 1;
        }
        
        .weather-detail-label {
            font-size: 11px;
            opacity: 0.7;
            margin-bottom: 5px;
        }
        
        .weather-detail-value {
            font-size: 14px;
            font-weight: 500;
        }
        
        .minmax-temp {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 14px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 10px;
        }
        
        .divider {
            height: 1px;
            background-color: var(--divider-bg);
            margin: 15px 0;
            width: 100%;
        }
        
        .moon-phase-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            padding: 10px;
        }
        
        .moon-icon {
            font-size: 30px;
            margin-right: 10px;
            filter: drop-shadow(0 0 5px rgba(255,255,255,0.5));
        }
        
        .moon-phase-text {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .weather-tabs {
            display: flex;
            margin-top: 15px;
            border-bottom: 1px solid var(--divider-bg);
        }
        
        .weather-tab {
            padding: 8px 12px;
            font-size: 14px;
            background: none;
            border: none;
            color: var(--text-color);
            opacity: 0.6;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            position: relative;
        }
        
        .weather-tab.active {
            opacity: 1;
        }
        
        .weather-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--accent-gradient);
        }
        
        .weather-tab:hover {
            opacity: 0.8;
        }
        
        .weather-content {
            display: none;
            margin-top: 15px;
        }
        
        .weather-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .weather-icon {
            font-size: 42px;
            margin-right: 15px;
            filter: drop-shadow(0 0 8px rgba(255,255,255,0.3));
        }
        
        .uv-meter {
            height: 6px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-top: 5px;
            position: relative;
            overflow: hidden;
        }
        
        .uv-value {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #22c55e, #eab308, #ef4444, #8b5cf6);
            width: 0%;
            transition: width 1s ease;
        }
        
        .forecast-container {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            overflow-x: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-color) var(--item-bg);
            padding-bottom: 10px;
            gap: 10px;
        }
        
        .forecast-container::-webkit-scrollbar {
            height: 5px;
        }
        
        .forecast-container::-webkit-scrollbar-track {
            background: var(--item-bg);
            border-radius: 10px;
        }
        
        .forecast-container::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 10px;
        }
        
        .forecast-item {
            flex: 0 0 auto;
            text-align: center;
            padding: 10px;
            min-width: 70px;
            background: var(--item-bg);
            border-radius: 10px;
            transition: transform 0.2s;
        }
        
        .forecast-item:hover {
            transform: translateY(-3px);
            background: rgba(255,255,255,0.1);
        }
        
        .forecast-day {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 5px;
        }
        
        .forecast-icon {
            font-size: 24px;
            margin-bottom: 5px;
            filter: drop-shadow(0 0 3px rgba(255,255,255,0.2));
        }
        
        .forecast-temp {
            font-size: 13px;
            font-weight: 500;
        }
        
        /* Clock & Date Widget */
        .clock-widget {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .clock {
            font-size: 42px;
            font-weight: 300;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
            position: relative;
        }
        
        .date {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 15px;
        }
        
        .quote {
            font-size: 14px;
            font-style: italic;
            opacity: 0.8;
            margin-top: 20px;
            text-align: center;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
            position: relative;
        }
        
        .quote::before, .quote::after {
            content: '"';
            font-size: 24px;
            color: var(--accent-color);
            opacity: 0.5;
        }
        
        /* News Widget */
        .news-widget {
            max-height: 400px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-color) var(--item-bg);
        }
        
        .news-widget::-webkit-scrollbar {
            width: 5px;
        }
        
        .news-widget::-webkit-scrollbar-track {
            background: var(--item-bg);
            border-radius: 10px;
        }
        
        .news-widget::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 10px;
        }
        
        .news-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--divider-bg);
            transition: transform 0.2s;
        }
        
        .news-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .news-item:hover {
            transform: translateX(5px);
        }
        
        .news-title {
            font-size: 15px;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .news-title a {
            color: var(--text-color);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .news-title a:hover {
            color: var(--accent-color);
        }
        
        .news-source {
            font-size: 12px;
            opacity: 0.7;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .news-date {
            font-size: 11px;
            opacity: 0.6;
        }
        
        /* Todo Widget */
        .todo-form {
            display: flex;
            margin-bottom: 15px;
        }
        
        .todo-input {
            flex: 1;
            background: var(--input-bg);
            border: none;
            padding: 10px 15px;
            border-radius: 10px 0 0 10px;
            color: var(--text-color);
        }
        
        .todo-input:focus {
            outline: none;
            background: rgba(255,255,255,0.15);
        }
        
        .todo-submit {
            background: var(--accent-gradient);
            border: none;
            padding: 10px 15px;
            border-radius: 0 10px 10px 0;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .todo-submit:hover {
            filter: brightness(1.1);
        }
        
        .todo-list {
            max-height: 250px;
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-color) var(--item-bg);
        }
        
        .todo-list::-webkit-scrollbar {
            width: 5px;
        }
        
        .todo-list::-webkit-scrollbar-track {
            background: var(--item-bg);
            border-radius: 10px;
        }
        
        .todo-list::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 10px;
        }
        
        .todo-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: var(--item-bg);
            border-radius: 10px;
            transition: all 0.2s;
        }
        
        .todo-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }
        
        .todo-checkbox {
            appearance: none;
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            margin-right: 10px;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .todo-checkbox:checked {
            background: var(--accent-color);
        }
        
        .todo-checkbox:checked::after {
            content: '✓';
            color: white;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 14px;
        }
        
        .todo-text {
            flex: 1;
            transition: all 0.2s;
        }
        
        .todo-item.completed .todo-text {
            text-decoration: line-through;
            opacity: 0.6;
        }
        
        .todo-delete {
            background: none;
            border: none;
            color: #f44336;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.2s;
        }
        
        .todo-delete:hover {
            opacity: 1;
            transform: scale(1.1);
        }
        
        .todo-clear {
            margin-top: 15px;
            background: none;
            border: 1px solid rgba(255,255,255,0.2);
            color: var(--text-color);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 12px;
            opacity: 0.7;
        }
        
        .todo-clear:hover {
            background: rgba(255,255,255,0.1);
            opacity: 1;
        }
        
        /* Notes Widget */
        .notes-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .note-editor {
            width: 100%;
            min-height: 100px;
            background: var(--input-bg);
            border: 1px solid var(--divider-bg);
            border-radius: 10px;
            padding: 10px;
            color: var(--text-color);
            font-family: inherit;
            resize: vertical;
            transition: all 0.2s;
        }
        
        .note-editor:focus {
            outline: none;
            background: rgba(255,255,255,0.1);
            border-color: var(--accent-color);
        }
        
        .note-actions {
            display: flex;
            justify-content: space-between;
        }
        
        .note-save {
            background: var(--accent-gradient);
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .note-save:hover {
            filter: brightness(1.1);
        }
        
        .note-clear {
            background: none;
            border: 1px solid var(--divider-bg);
            color: var(--text-color);
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            opacity: 0.7;
        }
        
        .note-clear:hover {
            background: rgba(255,255,255,0.1);
            opacity: 1;
        }
        
        /* Calendar Widget */
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .calendar-month {
            font-size: 16px;
            font-weight: 500;
        }
        
        .calendar-nav {
            display: flex;
            gap: 10px;
        }
        
        .calendar-nav-btn {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.2s;
        }
        
        .calendar-nav-btn:hover {
            opacity: 1;
            transform: scale(1.1);
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }
        
        .calendar-weekday {
            text-align: center;
            font-size: 12px;
            opacity: 0.7;
            padding: 5px;
        }
        
        .calendar-day {
            text-align: center;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        
        .calendar-day:hover {
            background: rgba(255,255,255,0.1);
        }
        
        .calendar-day.other-month {
            opacity: 0.4;
        }
        
        .calendar-day.today {
            background: var(--accent-color);
            color: white;
            font-weight: 500;
        }
        
        .calendar-day.has-event::after {
            content: '';
            position: absolute;
            bottom: 3px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--accent-color);
        }
        
        .calendar-day.today.has-event::after {
            background: white;
        }
        
        /* System Status Widget */
        .system-status-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .status-item {
            background: var(--item-bg);
            border-radius: 10px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.2s;
        }
        
        .status-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateY(-3px);
        }
        
        .status-icon {
            font-size: 24px;
            margin-bottom: 5px;
            color: var(--accent-color);
        }
        
        .status-label {
            font-size: 11px;
            opacity: 0.7;
        }
        
        .status-value {
            font-size: 14px;
            font-weight: 500;
        }
        
        .battery-indicator {
            width: 100%;
            height: 5px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .battery-level {
            height: 100%;
            background: linear-gradient(90deg, #22c55e, #eab308);
            transition: width 0.5s;
        }
        
        .battery-critical .battery-level {
            background: #f44336;
        }
        
        /* Settings Panel */
        .settings-btn {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all var(--transition-speed) ease;
            z-index: 900;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .settings-btn:hover {
            transform: rotate(30deg);
            background-color: rgba(60, 60, 60, 0.7);
        }
        
        .settings-panel {
            position: fixed;
            bottom: 130px;
            right: 20px;
            width: 320px;
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--card-radius);
            padding: 20px;
            transform: translateY(20px);
            opacity: 0;
            visibility: hidden;
            transition: all var(--transition-speed) ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 900;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .settings-panel.show {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }
        
        .settings-title {
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .settings-title i {
            color: var(--accent-color);
        }
        
        .settings-section {
            margin-bottom: 20px;
        }
        
        .settings-section h3 {
            font-size: 15px;
            margin-bottom: 12px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .settings-section h3 i {
            color: var(--accent-color);
            font-size: 18px;
        }
        
        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .settings-item label {
            font-size: 14px;
        }
        
        .url-input {
            width: 100%;
            padding: 10px 15px;
            font-size: 14px;
            border: none;
            border-radius: 10px;
            background-color: var(--input-bg);
            color: var(--text-color);
            margin-top: 8px;
            transition: all 0.2s;
        }
        
        .url-input:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.15);
            box-shadow: 0 0 0 2px rgba(var(--accent-color), 0.3);
        }
        
        .add-btn {
            background: var(--accent-gradient);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 18px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.25);
        }
        
        .theme-options {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            gap: 10px;
        }
        
        .theme-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .theme-btn:hover, .theme-btn.active {
            transform: scale(1.1);
            border-color: white;
        }
        
        .display-mode-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: .4s;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
        }
        
        input:checked + .slider {
            background-color: var(--accent-color);
        }
        
        input:focus + .slider {
            box-shadow: 0 0 1px var(--accent-color);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .slider.round {
            border-radius: 34px;
        }
        
        .slider.round:before {
            border-radius: 50%;
        }
        
        .select-container {
            position: relative;
            margin-top: 10px;
        }
        
        .select-container::after {
            content: '▼';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            pointer-events: none;
            font-size: 12px;
            opacity: 0.7;
        }
        
        .select-input {
            width: 100%;
            padding: 10px 15px;
            font-size: 14px;
            border: none;
            border-radius: 10px;
            background-color: var(--input-bg);
            color: var(--text-color);
            -webkit-appearance: none;
            appearance: none;
        }
        
        .select-input:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.15);
        }
        
        /* Background settings */
        .background-preview {
            width: 100%;
            height: 80px;
            border-radius: 10px;
            margin-top: 10px;
            margin-bottom: 10px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .bg-option {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .bg-radio {
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.3);
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .bg-radio:checked {
            border-color: var(--accent-color);
        }
        
        .bg-radio:checked::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-color);
        }
        
        .bg-label {
            font-size: 14px;
            cursor: pointer;
        }
        
        .color-picker {
            width: 100%;
            height: 30px;
            border: none;
            border-radius: 10px;
            background: rgba(255,255,255,0.1);
            cursor: pointer;
        }

        #custom-bg-container {
            display: none;
            margin-top: 8px;
        }
        
        /* Firefox message popup */
        .firefox-message {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        
        .firefox-message.show {
            opacity: 1;
            pointer-events: auto;
        }
        
        .message-content {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: var(--card-radius);
            padding: 25px;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            animation: messageIn 0.3s ease;
        }
        
        @keyframes messageIn {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        
        .message-content h3 {
            margin-bottom: 15px;
            color: var(--accent-color);
            font-size: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .message-content p {
            margin-bottom: 20px;
            line-height: 1.5;
            opacity: 0.9;
        }
        
        .message-content button {
            background: var(--accent-gradient);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        
        .message-content button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(0,0,0,0.25);
        }
        
        /* Light mode styles - The Pink/White Theme */
        body.light-mode {
            background-image: none;
            --bg-color: #ffffff; /* White background */
            --text-color: #5C474D; /* Dark, desaturated pink text */
            --accent-color: #D9899A; /* A stronger pink accent */
            --accent-gradient: linear-gradient(145deg, #E5A8B6, #D9899A); /* Pink gradient */
            --card-bg: rgba(249, 235, 239, 0.8); /* Soft pink for cards with transparency */
            --card-border: rgba(229, 168, 182, 0.4); /* Transparent pink border */
            --nav-bg: rgba(249, 235, 239, 0.9); /* Slightly transparent pink for nav */
            --input-bg: rgba(255, 255, 255, 0.7);
            --item-bg: rgba(247, 222, 229, 0.5); /* Background for smaller items */
            --divider-bg: rgba(229, 168, 182, 0.2); /* Transparent pink divider */
            --card-shadow: 0 5px 15px rgba(180, 150, 160, 0.1);
            --card-hover-shadow: 0 10px 20px rgba(180, 150, 160, 0.15);
            --accent-color-rgb: 217, 137, 154;
        }

        body.light-mode .shortcut:hover {
            background-color: var(--card-bg);
            opacity: 0.9;
        }

        body.light-mode .quote,
        body.light-mode .moon-phase-container,
        body.light-mode .minmax-temp {
            background: var(--item-bg);
        }

        body.light-mode .url-input::placeholder,
        body.light-mode .search-input::placeholder {
            color: var(--text-color);
            opacity: 0.6;
        }

        body.light-mode .slider:before {
            background-color: #333;
        }

        body.light-mode .switch input:checked + .slider:before {
            background-color: white;
        }
        
        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: var(--nav-bg);
            color: var(--text-color);
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.2s;
            font-size: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: var(--nav-bg) transparent transparent transparent;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background-color: rgba(255,255,255,0.2);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background-color: rgba(255,255,255,0.3);
        }
        
        /* Background patterns/options */
        .bg-pattern-dots {
            background-color: var(--bg-color);
            background-image: radial-gradient(rgba(255, 255, 255, 0.1) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .bg-pattern-grid {
            background-color: var(--bg-color);
            background-image: linear-gradient(rgba(255, 255, 255, 0.05) 1px, transparent 1px),
                             linear-gradient(90deg, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
            background-size: 20px 20px;
        }
        
        .bg-pattern-waves {
            background: linear-gradient(145deg, #121212, #202020);
            position: relative;
            overflow: hidden;
        }
        
        .bg-pattern-waves::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 800 800' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='rgba(255,255,255,0.03)' d='M22.3,-27.2C28.2,-22.6,32.2,-15.2,36,-6.2C39.8,2.9,43.4,13.5,40.2,22.3C37,31.1,27,38.1,16.6,39.8C6.2,41.5,-4.6,37.8,-12.7,32.4C-20.8,27,-26.2,19.8,-28.8,12.3C-31.4,4.8,-31.1,-3.1,-28.8,-10.8C-26.4,-18.4,-22,-25.9,-15.6,-30.5C-9.3,-35.1,-0.9,-36.8,4.5,-42C9.9,-47.1,16.4,-31.8,22.3,-27.2Z' transform='translate(400 400) scale(8)'/%3E%3C/svg%3E");
            background-size: cover;
            animation: wave-animation 25s linear infinite;
            opacity: 0.5;
        }
        
        @keyframes wave-animation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .bg-pattern-circuit {
            background-color: var(--bg-color);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 304 304' width='304' height='304'%3E%3Cpath fill='%23ffffff' fill-opacity='0.05' d='M44.1 224a5 5 0 1 1 0 2H0v-2h44.1zm160 48a5 5 0 1 1 0 2H82v-2h122.1zm57.8-46a5 5 0 1 1 0-2H304v2h-42.1zm0 16a5 5 0 1 1 0-2H304v2h-42.1zm6.2-114a5 5 0 1 1 0 2h-86.2a5 5 0 1 1 0-2h86.2zm-256-48a5 5 0 1 1 0 2H0v-2h12.1zm185.8 34a5 5 0 1 1 0-2h86.2a5 5 0 1 1 0 2h-86.2zM258 12.1a5 5 0 1 1-2 0V0h2v12.1zm-64 208a5 5 0 1 1-2 0v-54.2a5 5 0 1 1 2 0v54.2zm48-198.2V80h62v2h-64V21.9a5 5 0 1 1 2 0zm16 16V64h46v2h-48V37.9a5 5 0 1 1 2 0zm-128 96V208h16v12.1a5 5 0 1 1-2 0V210h-16v-76.1a5 5 0 1 1 2 0zm-5.9-21.9a5 5 0 1 1 0 2H114v48H85.9a5 5 0 1 1 0-2H112v-48h12.1zm-6.2 130a5 5 0 1 1 0-2H176v-74.1a5 5 0 1 1 2 0V242h-60.1zm-16-64a5 5 0 1 1 0-2H114v48h10.1a5 5 0 1 1 0 2H112v-48h-10.1zM66 284.1a5 5 0 1 1-2 0V274H50v30h-2v-32h18v12.1zM236.1 176a5 5 0 1 1 0 2H226v94h48v32h-2v-30h-48v-98h12.1zm25.8-30a5 5 0 1 1 0-2H274v44.1a5 5 0 1 1-2 0V146h-10.1zm-64 96a5 5 0 1 1 0-2H208v-80h16v-14h-42.1a5 5 0 1 1 0-2H226v18h-16v80h-12.1zm86.2-210a5 5 0 1 1 0 2H272V0h2v32h10.1zM98 101.9V146H53.9a5 5 0 1 1 0-2H96v-42.1a5 5 0 1 1 2 0zM53.9 34a5 5 0 1 1 0-2H80V0h2v34H53.9zm60.1 3.9V66H82v64H69.9a5 5 0 1 1 0-2H80V64h32V37.9a5 5 0 1 1 2 0zM101.9 82a5 5 0 1 1 0-2H128V37.9a5 5 0 1 1 2 0V82h-28.1zm16-64a5 5 0 1 1 0-2H146v44.1a5 5 0 1 1-2 0V18h-26.1zm102.2 270a5 5 0 1 1 0 2H98v14h-2v-16h124.1zM242 149.9V160h16v34h-16v62h48v48h-2v-46h-48v-66h16v-30h-16v-12.1a5 5 0 1 1 2 0zM53.9 18a5 5 0 1 1 0-2H64V2H48V0h18v18H53.9zm112 32a5 5 0 1 1 0-2H192V0h50v2h-48v48h-28.1zm-48-48a5 5 0 0 1-9.8-2h2.07a3 3 0 1 0 5.66 0H178v34h-18V21.9a5 5 0 1 1 2 0V32h14V2h-58.1zm0 96a5 5 0 1 1 0-2H137l32-32h39V21.9a5 5 0 1 1 2 0V66h-40.17l-32 32H117.9zm28.1 90.1a5 5 0 1 1-2 0v-76.51L175.59 80H224V21.9a5 5 0 1 1 2 0V82h-49.59L146 112.41v75.69zm16 32a5 5 0 1 1-2 0v-99.51L184.59 96H300.1a5 5 0 0 1 3.9-3.9v2.07a3 3 0 0 0 0 5.66v2.07a5 5 0 0 1-3.9-3.9H185.41L162 121.41v98.69zm-144-64a5 5 0 1 1-2 0v-3.51l48-48V48h32V0h2v50H66v55.41l-48 48v2.69zM50 53.9v43.51l-48 48V208h26.1a5 5 0 1 1 0 2H0v-65.41l48-48V53.9a5 5 0 1 1 2 0zm-16 16V89.41l-34 34v-2.82l32-32V69.9a5 5 0 1 1 2 0zM12.1 32a5 5 0 1 1 0 2H9.41L0 43.41V40.6L8.59 32h3.51zm265.8 18a5 5 0 1 1 0-2h18.69l7.41-7.41v2.82L297.41 50H277.9zm-16 160a5 5 0 1 1 0-2H288v-71.41l16-16v2.82l-14 14V210h-28.1zm-208 32a5 5 0 1 1 0-2H64v-22.59L40.59 194H21.9a5 5 0 1 1 0-2H41.41L66 217.59V242H53.9zm150.2 14a5 5 0 1 1 0 2H96v-56.6L56.6 162H37.9a5 5 0 1 1 0-2h19.5L98 200.6V256h106.1zm-150.2 2a5 5 0 1 1 0-2H80v-46.59L48.59 178H21.9a5 5 0 1 1 0-2H49.41L82 208.59V258H53.9zM34 39.8v1.61L9.41 66H0v-2h8.59L32 40.59V0h2v39.8zM2 300.1a5 5 0 0 1 3.9 3.9H3.83A3 3 0 0 0 0 302.17V256h18v48h-2v-46H2v42.1zM34 241v63h-2v-62H0v-2h34v1zM17 18H0v-2h16V0h2v18h-1zm273-2h14v2h-16V0h2v16zm-32 273v15h-2v-14h-14v14h-2v-16h18v1zM0 92.1A5.02 5.02 0 0 1 6 97a5 5 0 0 1-6 4.9v-2.07a3 3 0 1 0 0-5.66V92.1zM80 272h2v32h-2v-32zm37.9 32h-2.07a3 3 0 0 0-5.66 0h-2.07a5 5 0 0 1 9.8 0zM5.9 0A5.02 5.02 0 0 1 0 5.9V3.83A3 3 0 0 0 3.83 0H5.9zm294.2 0h2.07A3 3 0 0 0 304 3.83V5.9a5 5 0 0 1-3.9-5.9zm3.9 300.1v2.07a3 3 0 0 0-1.83 1.83h-2.07a5 5 0 0 1 3.9-3.9zM97 100a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-48 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 48a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 96a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-144a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-96 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm96 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-32 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM49 36a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-32 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM33 68a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-48a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 240a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm80-176a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 48a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm112 176a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm-16 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM17 180a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 16a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0-32a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16 0a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM17 84a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm32 64a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm16-16a3 3 0 1 0 0-6 3 3 0 0 0 0 6z'%3E%3C/path%3E%3C/svg%3E");
        }
        
        .bg-gradient-fancy {
            background: linear-gradient(45deg, #1a1a1a, #333333, #1a1a1a);
            background-size: 600% 600%;
            animation: gradientBG 15s ease infinite;
        }
        
        @keyframes gradientBG {
            0% { background-position: 0% 50% }
            50% { background-position: 100% 50% }
            100% { background-position: 0% 50% }
        }
        
        /* For smaller screens */
        @media (max-width: 768px) {
            .widgets-row {
                flex-direction: column;
                align-items: center;
            }
            
            .widget {
                max-width: 100%;
                margin-bottom: 0;
            }
            
            .search-container {
                max-width: 90%;
            }
            
            .shortcuts {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
                gap: 15px;
            }
            
            .shortcut {
                width: 80px;
                height: 80px;
            }
            
            .bottom-nav-item span {
                font-size: 10px;
            }
            
            .clock {
                font-size: 36px;
            }
            
            .weather-temp {
                font-size: 36px;
            }
            
            .weather-icon {
                font-size: 36px;
            }
            
            .settings-panel {
                width: 90%;
                max-width: 350px;
                right: 5%;
                left: 5%;
                margin: 0 auto;
            }
        }
        
        @media (max-width: 480px) {
            .shortcuts {
                grid-template-columns: repeat(4, 1fr);
                gap: 10px;
            }
            
            .shortcut {
                width: 70px;
                height: 70px;
            }
            
            .shortcut img {
                width: 30px;
                height: 30px;
            }
            
            .shortcut span {
                font-size: 11px;
            }
            
            .search-input {
                font-size: 14px;
                padding: 14px 15px 14px 45px;
            }
            
            .search-icon {
                font-size: 20px;
            }
            
            .weather-detail {
                flex-basis: 50%;
            }
            
            .clock {
                font-size: 32px;
            }
            
            .date {
                font-size: 14px;
            }
            
            .weather-temp {
                font-size: 32px;
            }
            
            .weather-icon {
                font-size: 32px;
            }
            
            .bottom-nav-item {
                padding: 8px 5px;
                width: auto;
            }
            
            .bottom-nav-item i {
                font-size: 20px;
            }
            
            .bottom-nav-item span {
                font-size: 9px;
            }
        }
        
        /* Animation utilities */
        .animate-bounce {
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .animate-pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .animate-spin {
            animation: spin 2s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .chat-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
            opacity: 0.8;
        }
        
        .chat-messages {
            max-height: 250px;
            overflow-y: auto;
            margin-bottom: 10px;
            padding: 10px;
            background: var(--item-bg);
            border-radius: 10px;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-color) var(--item-bg);
        }
        
        .chat-messages::-webkit-scrollbar {
            width: 5px;
        }
        
        .chat-messages::-webkit-scrollbar-track {
            background: var(--item-bg);
            border-radius: 10px;
        }
        
        .chat-messages::-webkit-scrollbar-thumb {
            background-color: var(--accent-color);
            border-radius: 10px;
        }
        
        .chat-message {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 10px;
            animation: fadeIn 0.3s ease;
            word-wrap: break-word;
        }
        
        .chat-message-own {
            background: rgba(var(--accent-color-rgb), 0.2);
            margin-left: 20px;
            border-top-right-radius: 2px;
        }
        
        .chat-message-other {
            background: var(--item-bg);
            margin-right: 20px;
            border-top-left-radius: 2px;
        }
        
        .chat-username {
            font-weight: 500;
            font-size: 12px;
            opacity: 0.8;
            margin-bottom: 3px;
        }
        
        .chat-text {
            font-size: 14px;
        }
        
        .chat-time {
            text-align: right;
            font-size: 10px;
            opacity: 0.6;
            margin-top: 3px;
        }
        
        .chat-input-area {
            margin-top: 10px;
        }
    </style>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body class="bg-pattern-dots">
    <!-- Firefox Logo with glow effect -->
    <div class="logo-container">
        <div class="logo-glow"></div>
        <img src="https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg" alt="Firefox Logo" class="logo">
    </div>

    <div class="container">
        <!-- Enhanced Search with icon and voice search -->
        <div class="search-container">
            <form class="search-form" id="search-form" action="https://www.google.com/search" method="GET">
                <span class="material-icons search-icon">search</span>
                <input type="text" name="q" class="search-input" placeholder="Mit Google suchen" autocomplete="off">
                <button type="button" class="material-icons voice-search" id="voice-search">mic</button>
            </form>
        </div>
        
        <!-- Shortcuts section with title and quick add button -->
        <div class="shortcuts-heading">
            <div class="shortcuts-title">Schnellzugriff</div>
            <button class="add-shortcut-quick" id="quick-add-shortcut">
                <span class="material-icons">add_circle</span> Hinzufügen
            </button>
        </div>
        
        <div class="shortcuts" id="shortcuts">
            <!-- Shortcuts will be dynamically generated -->
        </div>
        
        <!-- Widgets Container with multiple rows for better organization -->
        <div class="widgets-container">
            <!-- First row of widgets -->
            <div class="widgets-row">
                <!-- Weather Widget with enhanced UI -->
                <div class="widget">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="material-icons">cloud</span> Wetter
                        </div>
                        <div class="widget-actions">
                            <button class="widget-action refresh-weather" title="Aktualisieren">
                                <span class="material-icons">refresh</span>
                            </button>
                            <div class="tooltip">
                                <button class="widget-action" title="Standort">
                                    <span class="material-icons">location_on</span>
                                </button>
                                <span class="tooltiptext">Aktuellen Standort verwenden</span>
                            </div>
                        </div>
                    </div>
                    
                    <input type="text" id="location-input" class="url-input" placeholder="Ort eingeben" value="Berlin">
                    
                    <div class="weather-tabs">
                        <button class="weather-tab active" data-tab="current">Aktuell</button>
                        <button class="weather-tab" data-tab="details">Details</button>
                        <button class="weather-tab" data-tab="forecast">Vorhersage</button>
                    </div>
                    
                    <div id="current-weather" class="weather-content active">
                        <div class="weather-info">
                            <div class="weather-icon">🌤️</div>
                            <div>
                                <div class="weather-temp">--°C</div>
                                <div class="weather-desc">Wird geladen...</div>
                            </div>
                        </div>
                        
                        <div class="minmax-temp">
                            <span id="min-temp">Min: --°C</span>
                            <span id="max-temp">Max: --°C</span>
                        </div>
                        
                        <div class="divider"></div>
                        
                        <div class="weather-details">
                            <div class="weather-detail">
                                <div class="weather-detail-label">Luftfeuchtigkeit</div>
                                <div class="weather-detail-value" id="humidity">--%</div>
                            </div>
                            <div class="weather-detail">
                                <div class="weather-detail-label">Wind</div>
                                <div class="weather-detail-value" id="wind">-- km/h</div>
                            </div>
                            <div class="weather-detail">
                                <div class="weather-detail-label">Luftdruck</div>
                                <div class="weather-detail-value" id="pressure">-- hPa</div>
                            </div>
                            <div class="weather-detail">
                                <div class="weather-detail-label">Sichtweite</div>
                                <div class="weather-detail-value" id="visibility">-- km</div>
                            </div>
                            <div class="weather-detail">
                                <div class="weather-detail-label">UV-Index</div>
                                <div class="weather-detail-value" id="uv-index">--</div>
                                <div class="uv-meter">
                                    <div class="uv-value" id="uv-meter-value"></div>
                                </div>
                            </div>
                            <div class="weather-detail">
                                <div class="weather-detail-label">Gefühlt</div>
                                <div class="weather-detail-value" id="feels-like">--°C</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="details-weather" class="weather-content">
                        <div class="moon-phase-container">
                            <div class="moon-icon" id="moon-icon">🌕</div>
                            <div class="moon-phase-text" id="moon-phase">Mondphase wird geladen...</div>
                        </div>
                        
                        <div class="divider"></div>
                        
                        <div>
                            <div><strong>Sonnenaufgang:</strong> <span id="sunrise">--:--</span></div>
                            <div><strong>Sonnenuntergang:</strong> <span id="sunset">--:--</span></div>
                        </div>
                        
                        <div class="divider"></div>
                        
                        <div>
                            <div><strong>Taupunkt:</strong> <span id="dew-point">--°C</span></div>
                            <div><strong>Wolkenbedeckung:</strong> <span id="clouds">--%</span></div>
                        </div>
                    </div>
                    
                    <div id="forecast-weather" class="weather-content">
                        <div class="forecast-container" id="forecast-container">
                            <!-- Forecast will be dynamically generated -->
                        </div>
                    </div>
                </div>
                
                <!-- Clock & Date Widget with enhanced UI -->
                <div class="widget">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="material-icons">access_time</span> Datum & Uhrzeit
                        </div>
                    </div>
                    <div class="clock-widget">
                        <div class="clock" id="clock">00:00:00</div>
                        <div class="date" id="date">Wird geladen...</div>
                        <div class="quote" id="quote">Lade Zitat des Tages...</div>
                    </div>
                </div>
            </div>
            
            <!-- Second row of widgets -->
            <div class="widgets-row">
                <!-- News Widget (New) -->
                <div class="widget">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="material-icons">feed</span> Nachrichten
                        </div>
                        <div class="widget-actions">
                            <button class="widget-action refresh-news" title="Aktualisieren">
                                <span class="material-icons">refresh</span>
                            </button>
                        </div>
                    </div>
                    <div class="news-widget" id="news-container">
                        <div class="news-item">
                            <div class="news-title">Nachrichten werden geladen...</div>
                        </div>
                    </div>
                </div>
                
                <!-- Todo Widget (New) -->
                <div class="widget">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="material-icons">check_circle</span> Aufgaben
                        </div>
                    </div>
                    <form id="todo-form" class="todo-form">
                        <input type="text" id="todo-input" class="todo-input" placeholder="Neue Aufgabe hinzufügen...">
                        <button type="submit" class="todo-submit">
                            <span class="material-icons">add</span>
                        </button>
                    </form>
                    <div class="todo-list" id="todo-list">
                        <!-- Todo items will be dynamically generated -->
                    </div>
                    <button id="clear-completed" class="todo-clear">Erledigte Aufgaben löschen</button>
                </div>
            </div>
            
            <!-- Third row of widgets -->
            <div class="widgets-row">
                <!-- Notes Widget (New) -->
                <div class="widget">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="material-icons">note</span> Notizen
                        </div>
                    </div>
                    <div class="notes-container">
                        <textarea id="note-editor" class="note-editor" placeholder="Schreibe deine Notizen hier..."></textarea>
                        <div class="note-actions">
                            <button id="save-note" class="note-save">Speichern</button>
                            <button id="clear-note" class="note-clear">Löschen</button>
                        </div>
                    </div>
                </div>
                
                <!-- Calendar Widget (New) -->
                <div class="widget">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="material-icons">calendar_today</span> Kalender
                        </div>
                    </div>
                    <div class="calendar-header">
                        <div class="calendar-nav">
                            <button class="calendar-nav-btn" id="prev-month">
                                <span class="material-icons">chevron_left</span>
                            </button>
                        </div>
                        <div class="calendar-month" id="calendar-month">Mai 2025</div>
                        <div class="calendar-nav">
                            <button class="calendar-nav-btn" id="next-month">
                                <span class="material-icons">chevron_right</span>
                            </button>
                        </div>
                    </div>
                    <div class="calendar-grid" id="calendar-weekdays">
                        <!-- Weekday headers will be dynamically generated -->
                    </div>
                    <div class="calendar-grid" id="calendar-days">
                        <!-- Calendar days will be dynamically generated -->
                    </div>
                </div>
            </div>
            
            <!-- Fourth row of widgets -->
            <div class="widgets-row">
                <!-- System Status Widget (New) -->
                <div class="widget">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="material-icons">analytics</span> System Status
                        </div>
                        <div class="widget-actions">
                            <button class="widget-action refresh-status" title="Aktualisieren">
                                <span class="material-icons">refresh</span>
                            </button>
                        </div>
                    </div>
                    <div class="system-status-container">
                        <div class="status-item">
                            <span class="material-icons status-icon">battery_charging_full</span>
                            <span class="status-label">Akku</span>
                            <span class="status-value" id="battery-status">--</span>
                            <div class="battery-indicator">
                                <div class="battery-level" id="battery-level"></div>
                            </div>
                        </div>
                        <div class="status-item">
                            <span class="material-icons status-icon">memory</span>
                            <span class="status-label">Speicher</span>
                            <span class="status-value" id="memory-status">--</span>
                        </div>
                        <div class="status-item">
                            <span class="material-icons status-icon">wifi</span>
                            <span class="status-label">Netzwerk</span>
                            <span class="status-value" id="network-status">--</span>
                        </div>
                        <div class="status-item">
                            <span class="material-icons status-icon">speed</span>
                            <span class="status-label">Ladezeit</span>
                            <span class="status-value" id="page-load">--</span>
                        </div>
                    </div>
                </div>

                <!-- Chat Widget (New) -->
                <div class="widget">
                    <div class="widget-header">
                        <div class="widget-title">
                            <span class="material-icons">chat</span> Freunde-Chat
                        </div>
                        <div class="widget-actions">
                            <button class="widget-action" id="refresh-chat" title="Aktualisieren">
                                <span class="material-icons">refresh</span>
                            </button>
                        </div>
                    </div>
                    
                    <div id="chat-login-area" style="display: block;">
                        <input type="text" id="username-input" class="url-input" placeholder="Dein Benutzername">
                        <button id="login-button" class="add-btn" style="width: 100%;">
                            <span class="material-icons">login</span> Einloggen
                        </button>
                    </div>
                    
                    <div id="chat-area" style="display: none;">
                        <div class="chat-header">
                            <span id="logged-in-as">Eingeloggt als: </span>
                            <button id="logout-button" class="note-clear" style="margin-left: auto; padding: 4px 8px;">
                                <span class="material-icons" style="font-size: 16px;">logout</span>
                            </button>
                        </div>
                        
                        <div id="chat-messages" class="chat-messages">
                            <!-- Messages will appear here -->
                        </div>
                        
                        <div class="chat-input-area">
                            <input type="text" id="message-input" class="url-input" placeholder="Nachricht schreiben...">
                            <button id="send-button" class="add-btn" style="margin-top: 8px; width: 100%;">
                                <span class="material-icons">send</span> Senden
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Enhanced Bottom Navigation Bar -->
    <div class="bottom-nav">
        <a href="#" class="bottom-nav-item active" id="home-button">
            <span class="material-icons">home</span>
            <span>Startseite</span>
        </a>
        <a href="#" class="bottom-nav-item" id="bookmarks-button">
            <span class="material-icons">bookmark</span>
            <span>Lesezeichen</span>
        </a>
        <a href="#" class="bottom-nav-item" id="downloads-button">
            <span class="material-icons">download</span>
            <span>Downloads</span>
        </a>
        <a href="#" class="bottom-nav-item" id="history-button">
            <span class="material-icons">history</span>
            <span>Verlauf</span>
        </a>
        <a href="#" class="bottom-nav-item" id="addons-button">
            <span class="material-icons">extension</span>
            <span>Add-ons</span>
        </a>
    </div>
    
    <!-- Settings Button with enhanced animation -->
    <div class="settings-btn" id="settings-btn">
        <span class="material-icons">settings</span>
    </div>
    
    <!-- Enhanced Settings Panel with more options -->
    <div class="settings-panel" id="settings-panel">
        <div class="settings-title">
            <span class="material-icons">settings</span> Einstellungen
        </div>
        
        <div class="settings-section">
            <h3><span class="material-icons">add_link</span> Verknüpfung hinzufügen</h3>
            <div>
                <label for="shortcut-name">Name</label>
                <input type="text" id="shortcut-name" class="url-input" placeholder="z.B. YouTube">
            </div>
            <div>
                <label for="shortcut-url">URL</label>
                <input type="text" id="shortcut-url" class="url-input" placeholder="z.B. https://youtube.com">
            </div>
            <div>
                <label for="shortcut-icon">Icon URL (Optional)</label>
                <input type="text" id="shortcut-icon" class="url-input" placeholder="Standard-Favicon wird verwendet">
            </div>
            <button class="add-btn" id="add-shortcut-btn">
                <span class="material-icons">add</span> Hinzufügen
            </button>
        </div>
        
        <div class="divider"></div>
        
        <div class="settings-section">
            <h3><span class="material-icons">palette</span> Theme</h3>
            <div class="theme-options">
                <button class="theme-btn active" data-theme="firefox" style="background: linear-gradient(45deg, #ff9500, #e66000)"></button>
                <button class="theme-btn" data-theme="blue" style="background: linear-gradient(45deg, #0071e3, #005bb5)"></button>
                <button class="theme-btn" data-theme="green" style="background: linear-gradient(45deg, #28cd41, #1eb234)"></button>
                <button class="theme-btn" data-theme="purple" style="background: linear-gradient(45deg, #8A2BE2, #6a16c8)"></button>
                <button class="theme-btn" data-theme="pink" style="background: linear-gradient(45deg, #FF1493, #C71585)"></button>
            </div>
        </div>
        
        <div class="divider"></div>
        
        <div class="settings-section">
            <h3><span class="material-icons">dark_mode</span> Anzeigemodus</h3>
            <div class="display-mode-toggle">
                <span>Dunkel</span>
                <label class="switch">
                    <input type="checkbox" id="dark-mode-toggle">
                    <span class="slider round"></span>
                </label>
                <span>Hell</span>
            </div>
        </div>
        
        <div class="divider"></div>
        
        <div class="settings-section">
            <h3><span class="material-icons">search</span> Suchmaschine</h3>
            <div class="select-container">
                <select id="search-engine-select" class="select-input">
                    <option value="https://www.google.com/search">Google</option>
                    <option value="https://www.bing.com/search">Bing</option>
                    <option value="https://search.yahoo.com/search">Yahoo</option>
                    <option value="https://duckduckgo.com/">DuckDuckGo</option>
                    <option value="https://www.ecosia.org/search">Ecosia</option>
                </select>
            </div>
        </div>
        
        <div class="divider"></div>
        
        <div class="settings-section">
            <h3><span class="material-icons">wallpaper</span> Hintergrund</h3>
            <div class="bg-option">
                <input type="radio" id="bg-dots" name="bg-pattern" value="dots" class="bg-radio" checked>
                <label for="bg-dots" class="bg-label">Punkte</label>
            </div>
            <div class="bg-option">
                <input type="radio" id="bg-grid" name="bg-pattern" value="grid" class="bg-radio">
                <label for="bg-grid" class="bg-label">Gitter</label>
            </div>
            <div class="bg-option">
                <input type="radio" id="bg-waves" name="bg-pattern" value="waves" class="bg-radio">
                <label for="bg-waves" class="bg-label">Wellen</label>
            </div>
            <div class="bg-option">
                <input type="radio" id="bg-circuit" name="bg-pattern" value="circuit" class="bg-radio">
                <label for="bg-circuit" class="bg-label">Schaltkreis</label>
            </div>
            <div class="bg-option">
                <input type="radio" id="bg-gradient" name="bg-pattern" value="gradient" class="bg-radio">
                <label for="bg-gradient" class="bg-label">Farbverlauf</label>
            </div>
            <div class="bg-option">
                <input type="radio" id="bg-solid" name="bg-pattern" value="solid" class="bg-radio">
                <label for="bg-solid" class="bg-label">Einfarbig</label>
            </div>
            <div class="bg-option">
                <input type="radio" id="bg-custom" name="bg-pattern" value="custom" class="bg-radio">
                <label for="bg-custom" class="bg-label">Benutzerdefiniert</label>
            </div>
            <div id="custom-bg-container">
                 <input type="text" id="custom-bg-url" class="url-input" placeholder="Bild-URL einfügen...">
            </div>
        </div>
    </div>
    
    <!-- Firefox message popup with enhanced animation -->
    <div class="firefox-message" id="firefox-message">
        <div class="message-content">
            <h3><span class="material-icons">info</span> Firefox-Funktion</h3>
            <p id="message-text">Diese Funktion würde in einer echten Firefox-Erweiterung funktionieren.</p>
            <button id="close-message">Verstanden</button>
        </div>
    </div>
    
<!-- Firebase App (the core Firebase SDK) -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<!-- Firebase Auth -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<!-- Firebase Database -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
    // Initialize Firebase - Replace with your Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCgbZEjTgLsQ4NadP3afaS8nBW7_RByo5E",
      authDomain: "browserhost.firebaseapp.com",
      databaseURL: "https://browserhost-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "browserhost",
      storageBucket: "browserhost.firebasestorage.app",
      messagingSenderId: "1019208612410",
      appId: "1:1019208612410:web:1b57c879e16a4a87485303",
      measurementId: "G-5TM78L2J2Y"
    };
    
    // Initialize Firebase if not already initialized
    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }

    document.addEventListener('DOMContentLoaded', function() {
        const defaultShortcuts = [
            { name: 'YouTube', url: 'https://youtube.com', icon: 'https://www.youtube.com/favicon.ico' },
            { name: 'Gmail', url: 'https://mail.google.com', icon: 'https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico' },
            { name: 'Twitter', url: 'https://twitter.com', icon: 'https://twitter.com/favicon.ico' },
            { name: 'GitHub', url: 'https://github.com', icon: 'https://github.com/favicon.ico' },
            { name: 'Netflix', url: 'https://netflix.com', icon: 'https://assets.nflxext.com/us/ffe/siteui/common/icons/nficon2016.ico' },
            { name: 'Amazon', url: 'https://amazon.com', icon: 'https://www.amazon.com/favicon.ico' },
            { name: 'Reddit', url: 'https://reddit.com', icon: 'https://www.redditstatic.com/desktop2x/img/favicon/favicon-32x32.png' },
            { name: 'Wikipedia', url: 'https://wikipedia.org', icon: 'https://en.wikipedia.org/static/favicon/wikipedia.ico' }
        ];
        
        function loadShortcuts() {
            const shortcuts = JSON.parse(localStorage.getItem('shortcuts')) || defaultShortcuts;
            const shortcutsContainer = document.getElementById('shortcuts');
            shortcutsContainer.innerHTML = '';
            
            shortcuts.forEach((shortcut, index) => {
                const shortcutElement = document.createElement('a');
                shortcutElement.className = 'shortcut';
                shortcutElement.href = shortcut.url;
                
                const iconUrl = shortcut.icon || `https://www.google.com/s2/favicons?domain=${new URL(shortcut.url).hostname}&sz=64`;
                
                shortcutElement.innerHTML = `
                    <div class="remove-shortcut" data-index="${index}">×</div>
                    <img src="${iconUrl}" alt="${shortcut.name}" onerror="this.src='https://www.google.com/s2/favicons?domain=${new URL(shortcut.url).hostname}&sz=64'">
                    <span>${shortcut.name}</span>
                `;
                
                shortcutsContainer.appendChild(shortcutElement);
            });
            
            document.querySelectorAll('.remove-shortcut').forEach(button => {
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    const index = this.getAttribute('data-index');
                    removeShortcut(index);
                });
            });
        }
        
        function removeShortcut(index) {
            let shortcuts = JSON.parse(localStorage.getItem('shortcuts')) || defaultShortcuts;
            shortcuts.splice(index, 1);
            localStorage.setItem('shortcuts', JSON.stringify(shortcuts));
            loadShortcuts();
        }
        
        function updateClock() {
            const now = new Date();
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            
            document.getElementById('clock').textContent = now.toLocaleTimeString('de-DE', timeOptions);
            document.getElementById('date').textContent = now.toLocaleDateString('de-DE', dateOptions);
        }
        
        function getMoonPhase(date) {
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            let r = year % 100;
            r %= 19;
            if (r > 9) r -= 19;
            r = ((r * 11) % 30) + month + day;
            if (month < 3) r += 2;
            r -= ((year < 2000) ? 4 : 8.3);
            r = Math.floor(r + 0.5) % 30;
            if (r < 0) r += 30;
            
            let moonIcon, moonText;
            if (r < 1) { moonIcon = '🌑'; moonText = 'Neumond'; }
            else if (r < 7) { moonIcon = '🌒'; moonText = 'Zunehmender Sichelmond'; }
            else if (r < 8) { moonIcon = '🌓'; moonText = 'Erstes Viertel'; }
            else if (r < 14) { moonIcon = '🌔'; moonText = 'Zunehmender Mond'; }
            else if (r < 16) { moonIcon = '🌕'; moonText = 'Vollmond'; }
            else if (r < 22) { moonIcon = '🌖'; moonText = 'Abnehmender Mond'; }
            else if (r < 23) { moonIcon = '🌗'; moonText = 'Letztes Viertel'; }
            else { moonIcon = '🌘'; moonText = 'Abnehmender Sichelmond'; }
            return { icon: moonIcon, text: moonText };
        }
        
        async function getWeather(location) {
            try {
                document.querySelector('.weather-desc').textContent = 'Wird geladen...';
                document.querySelector('.weather-icon').classList.add('animate-pulse');
                
                const apiKey = '9de243494c0b295cca9337e1e96b00e2';
                const url = `https://api.openweathermap.org/data/2.5/weather?q=${location}&units=metric&lang=de&appid=${apiKey}`;
                const forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${location}&units=metric&lang=de&appid=${apiKey}`;
                
                const [weatherResponse, forecastResponse] = await Promise.all([fetch(url), fetch(forecastUrl)]);
                const data = await weatherResponse.json();
                const forecastData = await forecastResponse.json();
                
                if (data.cod === 200) {
                    const { main, weather, wind, visibility: vis, clouds, sys, name } = data;
                    const temp = Math.round(main.temp);
                    const feelsLike = Math.round(main.feels_like);
                    const description = weather[0].description.charAt(0).toUpperCase() + weather[0].description.slice(1);
                    const humidity = main.humidity;
                    const windSpeed = Math.round(wind.speed * 3.6);
                    const pressure = main.pressure;
                    const visibilityKm = (vis / 1000).toFixed(1);
                    const cloudsPercent = clouds.all;
                    const sunriseTime = new Date(sys.sunrise * 1000).toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });
                    const sunsetTime = new Date(sys.sunset * 1000).toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });
                    const dewPoint = Math.round(temp - ((100 - humidity) / 5));

                    let weatherIcon = '🌤️';
                    const weatherCode = weather[0].id;
                    if (weatherCode < 300) weatherIcon = '⛈️';
                    else if (weatherCode < 600) weatherIcon = '🌧️';
                    else if (weatherCode < 700) weatherIcon = '❄️';
                    else if (weatherCode < 800) weatherIcon = '🌫️';
                    else if (weatherCode === 800) weatherIcon = '☀️';
                    else if (weatherCode < 900) weatherIcon = '☁️';
                    
                    document.querySelector('.weather-icon').textContent = weatherIcon;
                    document.querySelector('.weather-icon').classList.remove('animate-pulse');
                    document.querySelector('.weather-temp').textContent = `${temp}°C`;
                    document.querySelector('.weather-desc').textContent = description;
                    document.getElementById('feels-like').textContent = `${feelsLike}°C`;
                    document.getElementById('humidity').textContent = `${humidity}%`;
                    document.getElementById('wind').textContent = `${windSpeed} km/h`;
                    document.getElementById('pressure').textContent = `${pressure} hPa`;
                    document.getElementById('visibility').textContent = `${visibilityKm} km`;
                    document.getElementById('clouds').textContent = `${cloudsPercent}%`;
                    document.getElementById('dew-point').textContent = `${dewPoint}°C`;
                    document.getElementById('sunrise').textContent = sunriseTime;
                    document.getElementById('sunset').textContent = sunsetTime;

                    let uvIndex = 0;
                    const hour = new Date().getHours();
                    if (hour >= 7 && hour <= 19) {
                        uvIndex = Math.round(8 * (1 - cloudsPercent / 100));
                    }
                    document.getElementById('uv-index').textContent = uvIndex;
                    document.getElementById('uv-meter-value').style.width = `${(uvIndex / 11) * 100}%`;
                    
                    if (forecastData.cod === '200') {
                        const todayForecasts = forecastData.list.filter(item => new Date(item.dt * 1000).setHours(0,0,0,0) === new Date().setHours(0,0,0,0));
                        if (todayForecasts.length > 0) {
                            const temps = todayForecasts.map(item => item.main.temp);
                            document.getElementById('min-temp').textContent = `Min: ${Math.round(Math.min(...temps))}°C`;
                            document.getElementById('max-temp').textContent = `Max: ${Math.round(Math.max(...temps))}°C`;
                        }
                        
                        const forecastContainer = document.getElementById('forecast-container');
                        forecastContainer.innerHTML = '';
                        const dailyForecasts = forecastData.list.filter((item, index) => index % 8 === 0).slice(0, 5);
                        dailyForecasts.forEach(item => {
                            const date = new Date(item.dt * 1000);
                            const dayName = date.toLocaleDateString('de-DE', { weekday: 'short' });
                            let fIcon = '🌤️';
                            const fCode = item.weather[0].id;
                            if (fCode < 300) fIcon = '⛈️';
                            else if (fCode < 600) fIcon = '🌧️';
                            else if (fCode < 700) fIcon = '❄️';
                            else if (fCode < 800) fIcon = '🌫️';
                            else if (fCode === 800) fIcon = '☀️';
                            else fIcon = '☁️';
                            const forecastElement = document.createElement('div');
                            forecastElement.className = 'forecast-item';
                            forecastElement.innerHTML = `<div class="forecast-day">${dayName}</div><div class="forecast-icon">${fIcon}</div><div class="forecast-temp">${Math.round(item.main.temp)}°C</div>`;
                            forecastContainer.appendChild(forecastElement);
                        });
                    }
                    
                    const moonPhase = getMoonPhase(new Date());
                    document.getElementById('moon-icon').textContent = moonPhase.icon;
                    document.getElementById('moon-phase').textContent = moonPhase.text;
                    localStorage.setItem('weatherLocation', location);
                } else {
                    throw new Error('Stadt nicht gefunden');
                }
            } catch (error) {
                console.error('Fehler beim Abrufen der Wetterdaten:', error);
                document.querySelector('.weather-desc').textContent = 'Stadt nicht gefunden';
                document.querySelector('.weather-icon').classList.remove('animate-pulse');
                document.querySelector('.weather-icon').textContent = '❓';
            }
        }

        function getQuote() {
            const quotes = [ "Der einzige Weg, großartige Arbeit zu leisten, ist zu lieben, was man tut.", "Innovation unterscheidet den Anführer vom Nachfolger.", "Deine Zeit ist begrenzt, also verschwende sie nicht damit, das Leben eines anderen zu leben.", "Die Zukunft gehört denen, die an die Schönheit ihrer Träume glauben.", "Das Leben ist das, was passiert, während du beschäftigt bist, andere Pläne zu machen." ];
            document.getElementById('quote').textContent = `"${quotes[Math.floor(Math.random() * quotes.length)]}"`;
        }
        
        function loadNews() {
            const newsContainer = document.getElementById('news-container');
            newsContainer.innerHTML = '<div class="news-item"><div class="news-title">Nachrichten werden geladen...</div></div>';
            setTimeout(() => {
                newsContainer.innerHTML = '';
                const newsItems = [{ title: 'Bundesregierung kündigt neue Klimaschutzmaßnahmen an', source: 'Tagesschau', url: '#', date: 'Heute' }, { title: 'Spannende technologische Innovationen auf der Tech Expo', source: 'Spiegel', url: '#', date: 'Gestern' }, { title: 'Neuer Rekord bei erneuerbaren Energien in Deutschland', source: 'Zeit', url: '#', date: 'Gestern' }];
                newsItems.forEach(item => {
                    const newsItem = document.createElement('div');
                    newsItem.className = 'news-item';
                    newsItem.innerHTML = `<div class="news-title"><a href="${item.url}" target="_blank">${item.title}</a></div><div class="news-source"><span>${item.source}</span><span class="news-date">${item.date}</span></div>`;
                    newsContainer.appendChild(newsItem);
                });
            }, 1000);
        }

        function initTodoList() {
            const todoList = document.getElementById('todo-list'), todoForm = document.getElementById('todo-form'), todoInput = document.getElementById('todo-input'), clearCompleted = document.getElementById('clear-completed');
            const loadTodos = () => {
                const todos = JSON.parse(localStorage.getItem('todos')) || [];
                todoList.innerHTML = todos.length ? '' : '<div style="text-align:center; padding:20px; opacity:0.7;">Keine Aufgaben vorhanden</div>';
                todos.forEach((todo, index) => {
                    const todoItem = document.createElement('div');
                    todoItem.className = `todo-item ${todo.completed ? 'completed' : ''}`;
                    todoItem.innerHTML = `<input type="checkbox" class="todo-checkbox" ${todo.completed ? 'checked' : ''} data-index="${index}"><span class="todo-text">${todo.text}</span><button class="todo-delete" data-index="${index}"><span class="material-icons">delete</span></button>`;
                    todoList.appendChild(todoItem);
                });
                document.querySelectorAll('.todo-checkbox').forEach(c => c.addEventListener('change', (e) => toggleTodo(e.target.dataset.index)));
                document.querySelectorAll('.todo-delete').forEach(b => b.addEventListener('click', (e) => deleteTodo(e.currentTarget.dataset.index)));
            }, saveTodos = (todos) => localStorage.setItem('todos', JSON.stringify(todos)), getTodos = () => JSON.parse(localStorage.getItem('todos')) || [],
            addTodo = (text) => saveTodos([...getTodos(), { text, completed: false }]),
            toggleTodo = (index) => { let todos = getTodos(); todos[index].completed = !todos[index].completed; saveTodos(todos); loadTodos(); },
            deleteTodo = (index) => saveTodos(getTodos().filter((_, i) => i != index)),
            clearCompletedTodos = () => { saveTodos(getTodos().filter(todo => !todo.completed)); loadTodos(); };
            todoForm.addEventListener('submit', (e) => { e.preventDefault(); const text = todoInput.value.trim(); if (text) { addTodo(text); todoInput.value = ''; loadTodos(); }});
            clearCompleted.addEventListener('click', clearCompletedTodos);
            loadTodos();
        }

        function initNotes() {
            const noteEditor = document.getElementById('note-editor'), saveNote = document.getElementById('save-note'), clearNote = document.getElementById('clear-note');
            noteEditor.value = localStorage.getItem('note') || '';
            saveNote.addEventListener('click', () => { localStorage.setItem('note', noteEditor.value); saveNote.classList.add('animate-pulse'); setTimeout(() => saveNote.classList.remove('animate-pulse'), 1000); });
            clearNote.addEventListener('click', () => { noteEditor.value = ''; localStorage.removeItem('note'); });
            let timeout; noteEditor.addEventListener('input', () => { clearTimeout(timeout); timeout = setTimeout(() => saveNote.click(), 1000); });
        }
        
        function initCalendar() {
            const calMonth = document.getElementById('calendar-month'), calWeekdays = document.getElementById('calendar-weekdays'), calDays = document.getElementById('calendar-days');
            let date = new Date(), month = date.getMonth(), year = date.getFullYear();
            const generateCalendar = () => {
                calMonth.textContent = `${new Date(year, month).toLocaleString('de-DE', { month: 'long', year: 'numeric' })}`;
                calDays.innerHTML = '';
                const firstDay = new Date(year, month, 1).getDay(), daysInMonth = new Date(year, month + 1, 0).getDate(),
                daysInPrevMonth = new Date(year, month, 0).getDate();
                for (let i = firstDay === 0 ? 6 : firstDay - 1; i > 0; i--) {
                    calDays.innerHTML += `<div class="calendar-day other-month">${daysInPrevMonth - i + 1}</div>`;
                }
                const today = new Date();
                for (let i = 1; i <= daysInMonth; i++) {
                    const isToday = i === today.getDate() && month === today.getMonth() && year === today.getFullYear();
                    calDays.innerHTML += `<div class="calendar-day ${isToday ? 'today' : ''} ${Math.random() < 0.15 ? 'has-event' : ''}">${i}</div>`;
                }
            };
            calWeekdays.innerHTML = ['Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa', 'So'].map(d => `<div class="calendar-weekday">${d}</div>`).join('');
            document.getElementById('prev-month').addEventListener('click', () => { month--; if (month < 0) { month = 11; year--; } generateCalendar(); });
            document.getElementById('next-month').addEventListener('click', () => { month++; if (month > 11) { month = 0; year++; } generateCalendar(); });
            generateCalendar();
        }

        function initSystemStatus() {
            const updateStatus = () => {
                document.getElementById('battery-status').textContent = `${Math.floor(Math.random()*85)+15}% ${Math.random()>0.5 ? '⚡' : ''}`;
                document.getElementById('battery-level').style.width = `${document.getElementById('battery-status').textContent.split('%')[0]}%`;
                document.getElementById('memory-status').textContent = `${Math.floor(Math.random()*45)+40}% verwendet`;
                document.getElementById('network-status').textContent = `WLAN (${Math.floor(Math.random()*100)+10} Mbps)`;
                document.getElementById('page-load').textContent = `${((new Date().getTime() - performance.timing.navigationStart) / 1000).toFixed(2)}s`;
            };
            document.querySelector('.refresh-status').addEventListener('click', function(){ this.classList.add('animate-spin'); setTimeout(() => { this.classList.remove('animate-spin'); updateStatus(); }, 1000); });
            updateStatus();
        }
        
        function initVoiceSearch() {
            document.getElementById('voice-search').addEventListener('click', () => {
                if (!('webkitSpeechRecognition' in window)) { return alert('Spracherkennung wird nicht unterstützt.'); }
                const recognition = new webkitSpeechRecognition();
                recognition.lang = 'de-DE'; recognition.start();
                document.getElementById('voice-search').classList.add('speech-recognition-active');
                recognition.onresult = (e) => { document.querySelector('.search-input').value = e.results[0][0].transcript; setTimeout(() => document.getElementById('search-form').submit(), 500); };
                recognition.onend = () => document.getElementById('voice-search').classList.remove('speech-recognition-active');
            });
        }
        
        function initWeatherTabs() {
            document.querySelectorAll('.weather-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.weather-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    document.querySelectorAll('.weather-content').forEach(c => c.classList.remove('active'));
                    document.getElementById(`${this.dataset.tab}-weather`).classList.add('active');
                });
            });
        }
        
        function initSettingsPanel() {
            const settingsPanel = document.getElementById('settings-panel'), settingsBtn = document.getElementById('settings-btn');
            settingsBtn.addEventListener('click', () => settingsPanel.classList.toggle('show'));
            document.addEventListener('click', (e) => {
                if (!settingsPanel.contains(e.target) && !settingsBtn.contains(e.target)) settingsPanel.classList.remove('show');
            });
        }
        
        function initShortcutManager() {
            document.getElementById('add-shortcut-btn').addEventListener('click', () => {
                let name = document.getElementById('shortcut-name').value.trim(), url = document.getElementById('shortcut-url').value.trim();
                if (!name || !url) return alert('Name und URL sind erforderlich');
                if (!url.startsWith('http')) url = 'https://' + url;
                const icon = document.getElementById('shortcut-icon').value.trim();
                const shortcuts = JSON.parse(localStorage.getItem('shortcuts')) || defaultShortcuts;
                shortcuts.push({ name, url, icon: icon || `https://www.google.com/s2/favicons?domain=${new URL(url).hostname}&sz=64` });
                localStorage.setItem('shortcuts', JSON.stringify(shortcuts));
                loadShortcuts();
                ['shortcut-name', 'shortcut-url', 'shortcut-icon'].forEach(id => document.getElementById(id).value = '');
                document.getElementById('settings-panel').classList.remove('show');
            });
            document.getElementById('quick-add-shortcut').addEventListener('click', () => { document.getElementById('settings-panel').classList.add('show'); document.getElementById('shortcut-name').focus(); });
        }
        
        function initWeatherInput() {
            const locationInput = document.getElementById('location-input');
            locationInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') getWeather(locationInput.value.trim()); });
            document.querySelector('.refresh-weather').addEventListener('click', function() { getWeather(locationInput.value.trim() || 'Berlin'); });
        }

        function setBackground(pattern, url = null) {
            document.body.className = document.body.className.replace(/bg-pattern-\w+|bg-gradient-fancy/g, '');
            document.body.style.backgroundImage = '';
            document.body.style.backgroundColor = '';

            switch (pattern) {
                case 'custom':
                    if (url) {
                        document.body.style.backgroundImage = `url('${url}')`;
                    }
                    break;
                case 'solid':
                    // Uses --bg-color from the theme
                    break;
                case 'gradient':
                    document.body.classList.add('bg-gradient-fancy');
                    break;
                default:
                    document.body.classList.add(`bg-pattern-${pattern}`);
                    break;
            }
        }
        
        function initThemeSettings() {
            const root = document.documentElement;
            const customBgContainer = document.getElementById('custom-bg-container');
            const customBgUrlInput = document.getElementById('custom-bg-url');

            document.querySelectorAll('.theme-btn').forEach(btn => btn.addEventListener('click', function() {
                const theme = this.getAttribute('data-theme');
                document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                let color, gradient;
                switch(theme) {
                    case 'blue': color = '#0071e3'; gradient = 'linear-gradient(145deg, #0071e3, #005bb5)'; break;
                    case 'green': color = '#28cd41'; gradient = 'linear-gradient(145deg, #28cd41, #1eb234)'; break;
                    case 'purple': color = '#8A2BE2'; gradient = 'linear-gradient(145deg, #8A2BE2, #6a16c8)'; break;
                    case 'pink': color = '#FF1493'; gradient = 'linear-gradient(145deg, #FF1493, #C71585)'; break;
                    default: color = '#ff9500'; gradient = 'linear-gradient(145deg, #ff9500, #e66000)'; break;
                }
                root.style.setProperty('--accent-color', color);
                root.style.setProperty('--accent-gradient', gradient);
                localStorage.setItem('theme', theme);
            }));
            
            const darkModeToggle = document.getElementById('dark-mode-toggle');
            darkModeToggle.addEventListener('change', function() {
                document.body.classList.toggle('light-mode', this.checked);
                localStorage.setItem('lightMode', this.checked ? 'true' : 'false');
            });
            
            document.getElementById('search-engine-select').addEventListener('change', function() {
                document.getElementById('search-form').action = this.value;
                localStorage.setItem('searchEngine', this.value);
            });
            
            document.querySelectorAll('input[name="bg-pattern"]').forEach(radio => radio.addEventListener('change', function() {
                const pattern = this.value;
                localStorage.setItem('bgPattern', pattern);
                customBgContainer.style.display = pattern === 'custom' ? 'block' : 'none';
                setBackground(pattern, customBgUrlInput.value.trim());
            }));

            customBgUrlInput.addEventListener('change', function() {
                const url = this.value.trim();
                localStorage.setItem('customBgUrl', url);
                if (document.getElementById('bg-custom').checked) {
                    setBackground('custom', url);
                }
            });
        
            // LOAD SETTINGS ON STARTUP
            const savedTheme = localStorage.getItem('theme') || 'firefox';
            document.querySelector(`.theme-btn[data-theme="${savedTheme}"]`)?.click();
            const isLightMode = localStorage.getItem('lightMode') === 'true';
            darkModeToggle.checked = isLightMode;
            document.body.classList.toggle('light-mode', isLightMode);
            const savedSearchEngine = localStorage.getItem('searchEngine');
            if (savedSearchEngine) document.getElementById('search-engine-select').value = savedSearchEngine;
            
            const savedPattern = localStorage.getItem('bgPattern') || 'dots';
            const savedCustomUrl = localStorage.getItem('customBgUrl') || '';
            document.querySelector(`input[name="bg-pattern"][value="${savedPattern}"]`).checked = true;
            customBgUrlInput.value = savedCustomUrl;
            if (savedPattern === 'custom') customBgContainer.style.display = 'block';
            setBackground(savedPattern, savedCustomUrl);
        }

        function initBrowserActions() {
            const showMessage = (action) => {
                const message = document.getElementById('firefox-message');
                document.getElementById('message-text').textContent = `Die Funktion (${action}) ist in dieser Demo-Umgebung nicht verfügbar.`;
                message.classList.add('show');
            }
            document.getElementById('bookmarks-button').addEventListener('click', (e) => { e.preventDefault(); showMessage('Lesezeichen'); });
            document.getElementById('downloads-button').addEventListener('click', (e) => { e.preventDefault(); showMessage('Downloads'); });
            document.getElementById('history-button').addEventListener('click', (e) => { e.preventDefault(); showMessage('Verlauf'); });
            document.getElementById('addons-button').addEventListener('click', (e) => { e.preventDefault(); showMessage('Add-ons'); });
            document.getElementById('home-button').addEventListener('click', (e) => e.preventDefault());
            document.getElementById('close-message').addEventListener('click', () => document.getElementById('firefox-message').classList.remove('show'));
        }

        function initChat() {
            const auth = firebase.auth(); const database = firebase.database();
            const loginArea = document.getElementById('chat-login-area'), chatArea = document.getElementById('chat-area'),
            usernameInput = document.getElementById('username-input'), loginButton = document.getElementById('login-button'),
            logoutButton = document.getElementById('logout-button'), loggedInAs = document.getElementById('logged-in-as'),
            messageInput = document.getElementById('message-input'), sendButton = document.getElementById('send-button'),
            chatMessages = document.getElementById('chat-messages');
            let currentUser = null;

            const updateUI = (loggedIn) => {
                loginArea.style.display = loggedIn ? 'none' : 'block';
                chatArea.style.display = loggedIn ? 'block' : 'none';
                if (loggedIn) {
                    loggedInAs.textContent = `Eingeloggt als: ${currentUser}`;
                    loadMessages();
                } else {
                    chatMessages.innerHTML = '';
                }
            };

            const login = () => { const username = usernameInput.value.trim(); if(username){ localStorage.setItem('chatUsername', username); currentUser = username; updateUI(true); }};
            const logout = () => { localStorage.removeItem('chatUsername'); currentUser = null; updateUI(false); };
            const sendMessage = () => {
                const message = messageInput.value.trim();
                if(message && currentUser) {
                    database.ref('messages').push({ username: currentUser, text: message, timestamp: firebase.database.ServerValue.TIMESTAMP });
                    messageInput.value = '';
                }
            };
            const loadMessages = () => {
                database.ref('messages').orderByChild('timestamp').limitToLast(50).on('value', (snapshot) => {
                    chatMessages.innerHTML = '';
                    if (snapshot.exists()) {
                        Object.values(snapshot.val()).sort((a,b) => a.timestamp - b.timestamp).forEach(msg => {
                            const msgEl = document.createElement('div');
                            const isOwn = msg.username === currentUser;
                            msgEl.className = `chat-message ${isOwn ? 'chat-message-own' : 'chat-message-other'}`;
                            const time = new Date(msg.timestamp).toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });
                            msgEl.innerHTML = `<div class="chat-username">${msg.username}</div><div class="chat-text">${msg.text}</div><div class="chat-time">${time}</div>`;
                            chatMessages.appendChild(msgEl);
                        });
                        chatMessages.scrollTop = chatMessages.scrollHeight;
                    }
                });
            };

            loginButton.addEventListener('click', login);
            logoutButton.addEventListener('click', logout);
            sendButton.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') sendMessage(); });
            document.getElementById('refresh-chat').addEventListener('click', loadMessages);
            currentUser = localStorage.getItem('chatUsername');
            if(currentUser) updateUI(true);
        }

        // --- INITIALIZE EVERYTHING ---
        loadShortcuts();
        updateClock();
        setInterval(updateClock, 1000);
        getWeather(localStorage.getItem('weatherLocation') || 'Berlin');
        getQuote();
        loadNews();
        initTodoList();
        initNotes();
        initCalendar();
        initSystemStatus();
        initVoiceSearch();
        initWeatherTabs();
        initSettingsPanel();
        initShortcutManager();
        initWeatherInput();
        initThemeSettings();
        initBrowserActions();
        initChat();
    });
</script>
</body>
</html>
