<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firefox Startseite</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-color: #f5f5f7;
            --accent-color: #0071e3;
            --card-bg: rgba(40, 40, 40, 0.7);
            --card-border: rgba(80, 80, 80, 0.3);
            --nav-bg: rgba(30, 30, 30, 0.9);
            --firefox-red: #e66000;
            --firefox-orange: #ff9500;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
            background: linear-gradient(145deg, #121212, #202020);
            padding-top: 20px;
            padding-bottom: 70px;
        }
        
        /* Bottom Navigation Bar */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            background-color: var(--nav-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            justify-content: space-around;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.2);
        }
        
        .bottom-nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-color);
            opacity: 0.7;
            transition: opacity 0.2s;
            text-decoration: none;
            padding: 8px;
            border-radius: 8px;
        }
        
        .bottom-nav-item:hover, .bottom-nav-item.active {
            opacity: 1;
            background-color: rgba(255, 255, 255, 0.1);
        }
        
        .bottom-nav-item i {
            font-size: 20px;
            margin-bottom: 4px;
        }
        
        .bottom-nav-item span {
            font-size: 11px;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
            padding: 20px;
            flex: 1;
        }
        
        .search-container {
            margin: 30px auto;
            width: 100%;
            max-width: 580px;
            position: relative;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .search-container:hover {
            transform: translateY(-2px);
        }
        
        .search-form {
            display: flex;
            width: 100%;
        }
        
        .search-input {
            width: 100%;
            padding: 15px 20px;
            font-size: 16px;
            border: none;
            border-radius: 12px;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .search-input:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.15);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }
        
        .shortcuts {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 20px;
            margin: 40px auto;
            max-width: 800px;
            justify-content: center;
            padding: 0 15px;
        }
        
        .shortcut {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 80px;
            height: 80px;
            border-radius: 16px;
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: var(--text-color);
        }
        
        .shortcut:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            background-color: rgba(60, 60, 60, 0.7);
        }
        
        .shortcut img {
            width: 32px;
            height: 32px;
            margin-bottom: 8px;
            border-radius: 8px;
        }
        
        .shortcut span {
            font-size: 12px;
        }
        
        .widgets {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px auto;
            width: 100%;
            max-width: 1000px;
        }
        
        .widget {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 20px;
            width: 100%;
            max-width: 380px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .widget:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }
        
        .widget-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 15px;
            color: var(--text-color);
            opacity: 0.9;
        }
        
        .weather-info {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .weather-temp {
            font-size: 36px;
            font-weight: 300;
        }
        
        .weather-desc {
            font-size: 14px;
            opacity: 0.8;
            margin-top: 5px;
        }
        
        .weather-details {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        
        .weather-detail {
            text-align: center;
            font-size: 12px;
            opacity: 0.8;
            flex-basis: 33%;
            margin-bottom: 10px;
        }
        
        .minmax-temp {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 14px;
        }
        
        .divider {
            height: 1px;
            background-color: rgba(255, 255, 255, 0.1);
            margin: 15px 0;
            width: 100%;
        }
        
        .moon-phase-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 10px;
        }
        
        .moon-icon {
            font-size: 24px;
            margin-right: 10px;
        }
        
        .moon-phase-text {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .weather-tabs {
            display: flex;
            margin-top: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .weather-tab {
            padding: 8px 12px;
            font-size: 14px;
            background: none;
            border: none;
            color: var(--text-color);
            opacity: 0.6;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .weather-tab.active {
            opacity: 1;
            border-bottom: 2px solid var(--accent-color);
        }
        
        .weather-tab:hover {
            opacity: 0.8;
        }
        
        .weather-content {
            display: none;
            margin-top: 15px;
        }
        
        .weather-content.active {
            display: block;
        }
        
        .clock {
            font-size: 36px;
            font-weight: 300;
            margin-bottom: 10px;
        }
        
        .date {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .quote {
            font-size: 14px;
            font-style: italic;
            opacity: 0.8;
            margin-top: 20px;
        }
        
        .location-input {
            width: 100%;
            padding: 8px 12px;
            font-size: 14px;
            border: none;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            margin-top: 10px;
        }
        
        .location-input:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.15);
        }
        
        .weather-icon {
            font-size: 36px;
            margin-right: 10px;
        }
        
        .uv-meter {
            height: 6px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            margin-top: 5px;
            position: relative;
            overflow: hidden;
        }
        
        .uv-value {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #22c55e, #eab308, #ef4444, #8b5cf6);
            width: 0%;
            transition: width 1s ease;
        }
        
        .settings-btn {
            position: fixed;
            bottom: 70px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 900;
        }
        
        .settings-btn:hover {
            transform: rotate(180deg);
            background-color: rgba(60, 60, 60, 0.7);
        }
        
        .settings-panel {
            position: fixed;
            bottom: 130px;
            right: 20px;
            width: 300px;
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 16px;
            padding: 20px;
            transform: translateY(20px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 900;
        }
        
        .settings-panel.show {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }
        
        .settings-title {
            font-size: 16px;
            font-weight: 500;
            margin-bottom: 15px;
        }
        
        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        
        .settings-item label {
            font-size: 14px;
        }
        
        .url-input {
            width: 100%;
            padding: 8px 12px;
            font-size: 14px;
            border: none;
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--text-color);
            margin-top: 5px;
        }
        
        .url-input:focus {
            outline: none;
            background-color: rgba(255, 255, 255, 0.15);
        }
        
        .add-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .add-btn:hover {
            background-color: #0077ED;
        }
        
        .forecast-container {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .forecast-item {
            flex: 0 0 auto;
            text-align: center;
            margin-right: 15px;
            min-width: 60px;
        }
        
        .forecast-item:last-child {
            margin-right: 0;
        }
        
        .forecast-day {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 5px;
        }
        
        .forecast-icon {
            font-size: 20px;
            margin-bottom: 5px;
        }
        
        .forecast-temp {
            font-size: 12px;
        }
        
        /* For smaller screens */
        @media (max-width: 768px) {
            .widgets {
                flex-direction: column;
                align-items: center;
            }
            
            .widget {
                max-width: 100%;
                margin-bottom: 20px;
            }
            
            .search-container {
                max-width: 90%;
            }
            
            .shortcuts {
                grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
                gap: 15px;
            }
            
            .shortcut {
                width: 70px;
                height: 70px;
            }
            
            .top-nav-actions {
                gap: 8px;
            }
            
            .bottom-nav-item span {
                font-size: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .shortcuts {
                grid-template-columns: repeat(4, 1fr);
                gap: 10px;
            }
            
            .shortcut {
                width: 60px;
                height: 60px;
            }
            
            .shortcut img {
                width: 28px;
                height: 28px;
            }
            
            .firefox-title {
                display: none;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <!-- Firefox Logo -->
    <div style="text-align: center; margin-bottom: 20px;">
        <img src="https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg" alt="Firefox Logo" style="height: 50px;">
    </div>

    <div class="container">
        <div class="search-container">
            <form class="search-form" id="search-form" action="https://www.google.com/search" method="GET">
                <input type="text" name="q" class="search-input" placeholder="Mit Google suchen" autocomplete="off">
            </form>
        </div>
        
        <!-- Top Sites Section -->
        <h2 class="section-title">Häufig besucht</h2>
        <div class="top-sites" id="top-sites-container">
            <!-- Top sites will be dynamically generated -->
        </div>
        
        <h2 class="section-title">Verknüpfungen</h2>
        <div class="shortcuts" id="shortcuts">
            <!-- Shortcuts will be dynamically generated -->
        </div>
        
        <div class="widgets">
            <div class="widget">
                <div class="widget-title">Wetter</div>
                <input type="text" id="location-input" class="location-input" placeholder="Ort eingeben" value="Berlin">
                
                <div class="weather-tabs">
                    <button class="weather-tab active" data-tab="current">Aktuell</button>
                    <button class="weather-tab" data-tab="details">Details</button>
                    <button class="weather-tab" data-tab="forecast">Vorhersage</button>
                </div>
                
                <div id="current-weather" class="weather-content active">
                    <div class="weather-info">
                        <div class="weather-icon">🌤️</div>
                        <div>
                            <div class="weather-temp">--°C</div>
                            <div class="weather-desc">Wird geladen...</div>
                        </div>
                    </div>
                    
                    <div class="minmax-temp">
                        <span id="min-temp">Min: --°C</span>
                        <span id="max-temp">Max: --°C</span>
                    </div>
                    
                    <div class="divider"></div>
                    
                    <div class="weather-details">
                        <div class="weather-detail">
                            <div>Luftfeuchtigkeit</div>
                            <div id="humidity">--%</div>
                        </div>
                        <div class="weather-detail">
                            <div>Wind</div>
                            <div id="wind">-- km/h</div>
                        </div>
                        <div class="weather-detail">
                            <div>Luftdruck</div>
                            <div id="pressure">-- hPa</div>
                        </div>
                        <div class="weather-detail">
                            <div>Sichtweite</div>
                            <div id="visibility">-- km</div>
                        </div>
                        <div class="weather-detail">
                            <div>UV-Index</div>
                            <div id="uv-index">--</div>
                            <div class="uv-meter">
                                <div class="uv-value" id="uv-meter-value"></div>
                            </div>
                        </div>
                        <div class="weather-detail">
                            <div>Gefühlt</div>
                            <div id="feels-like">--°C</div>
                        </div>
                    </div>
                </div>
                
                <div id="details-weather" class="weather-content">
                    <div class="moon-phase-container">
                        <div class="moon-icon" id="moon-icon">🌕</div>
                        <div class="moon-phase-text" id="moon-phase">Mondphase wird geladen...</div>
                    </div>
                    
                    <div class="divider"></div>
                    
                    <div>
                        <div><strong>Sonnenaufgang:</strong> <span id="sunrise">--:--</span></div>
                        <div><strong>Sonnenuntergang:</strong> <span id="sunset">--:--</span></div>
                    </div>
                    
                    <div class="divider"></div>
                    
                    <div>
                        <div><strong>Taupunkt:</strong> <span id="dew-point">--°C</span></div>
                        <div><strong>Wolkenbedeckung:</strong> <span id="clouds">--%</span></div>
                    </div>
                </div>
                
                <div id="forecast-weather" class="weather-content">
                    <div class="forecast-container" id="forecast-container">
                        <!-- Forecast will be dynamically generated -->
                    </div>
                </div>
            </div>
            
            <div class="widget">
                <div class="widget-title">Datum & Uhrzeit</div>
                <div class="clock" id="clock">00:00:00</div>
                <div class="date" id="date">Wird geladen...</div>
                <div class="quote" id="quote">Lade Zitat des Tages...</div>
            </div>
        </div>
    </div>
    
    <!-- Bottom Navigation Bar -->
    <div class="bottom-nav">
        <a href="#" class="bottom-nav-item active" id="home-button">
            <span class="material-icons">home</span>
            <span>Startseite</span>
        </a>
        <a href="#" class="bottom-nav-item" id="bookmarks-button">
            <span class="material-icons">bookmark</span>
            <span>Lesezeichen</span>
        </a>
        <a href="#" class="bottom-nav-item" id="downloads-button">
            <span class="material-icons">download</span>
            <span>Downloads</span>
        </a>
        <a href="#" class="bottom-nav-item" id="history-button">
            <span class="material-icons">history</span>
            <span>Verlauf</span>
        </a>
        <a href="#" class="bottom-nav-item" id="addons-button">
            <span class="material-icons">extension</span>
            <span>Add-ons</span>
        </a>
    </div>
    
    <div class="settings-btn" id="settings-btn">
        <span class="material-icons">settings</span>
    </div>
    
    <div class="settings-panel" id="settings-panel">
        <div class="settings-title">Einstellungen</div>
        
        <div class="settings-section">
            <h3>Verknüpfung hinzufügen</h3>
            <div>
                <label for="shortcut-name">Name</label>
                <input type="text" id="shortcut-name" class="url-input" placeholder="z.B. YouTube">
            </div>
            <div>
                <label for="shortcut-url">URL</label>
                <input type="text" id="shortcut-url" class="url-input" placeholder="z.B. https://youtube.com">
            </div>
            <div>
                <label for="shortcut-icon">Icon URL (Optional)</label>
                <input type="text" id="shortcut-icon" class="url-input" placeholder="Standard-Favicon wird verwendet">
            </div>
            <button class="add-btn" id="add-shortcut-btn">Hinzufügen</button>
        </div>
        
        <div class="divider"></div>
        
        <div class="settings-section">
            <h3>Theme</h3>
            <div class="theme-options">
                <button class="theme-btn" data-theme="firefox" style="background: linear-gradient(45deg, #ff9500, #e66000)"></button>
                <button class="theme-btn" data-theme="blue" style="background: #0071e3"></button>
                <button class="theme-btn" data-theme="green" style="background: #28cd41"></button>
                <button class="theme-btn" data-theme="purple" style="background: #8A2BE2"></button>
            </div>
        </div>
        
        <div class="divider"></div>
        
        <div class="settings-section">
            <h3>Anzeigemodus</h3>
            <div class="display-mode-toggle">
                <span>Dunkel</span>
                <label class="switch">
                    <input type="checkbox" id="dark-mode-toggle">
                    <span class="slider round"></span>
                </label>
                <span>Hell</span>
            </div>
        </div>
        
        <div class="divider"></div>
        
        <div class="settings-section">
            <h3>Suchmaschine</h3>
            <select id="search-engine-select" class="url-input">
                <option value="https://www.google.com/search">Google</option>
                <option value="https://www.bing.com/search">Bing</option>
                <option value="https://search.yahoo.com/search">Yahoo</option>
                <option value="https://duckduckgo.com/">DuckDuckGo</option>
            </select>
        </div>
    </div>
    
    <style>
        .settings-section {
            margin-bottom: 15px;
        }
        
        .settings-section h3 {
            font-size: 14px;
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .theme-options {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        
        .theme-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .theme-btn:hover, .theme-btn.active {
            transform: scale(1.1);
            border-color: white;
        }
        
        .display-mode-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: .4s;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
        }
        
        input:checked + .slider {
            background-color: var(--accent-color);
        }
        
        input:focus + .slider {
            box-shadow: 0 0 1px var(--accent-color);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .slider.round {
            border-radius: 34px;
        }
        
        .slider.round:before {
            border-radius: 50%;
        }
        
        /* Top sites section */
        .top-sites {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px auto;
            max-width: 800px;
        }
        
        .top-site-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 70px;
            text-decoration: none;
            color: var(--text-color);
            opacity: 0.8;
            transition: all 0.2s;
        }
        
        .top-site-item:hover {
            opacity: 1;
            transform: translateY(-5px);
        }
        
        .top-site-item img {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            margin-bottom: 5px;
        }
        
        .section-title {
            font-size: 18px;
            font-weight: 500;
            margin: 20px 0 10px;
            text-align: center;
            opacity: 0.8;
        }
        
        /* Light mode styles */
        body.light-mode {
            background: linear-gradient(145deg, #f5f5f7, #e2e2e7);
            color: #333;
        }
        
        body.light-mode .widget,
        body.light-mode .shortcut,
        body.light-mode .settings-panel,
        body.light-mode .settings-btn,
        body.light-mode .bottom-nav {
            background-color: rgba(255, 255, 255, 0.7);
            border-color: rgba(200, 200, 200, 0.3);
        }
        
        body.light-mode .search-input,
        body.light-mode .url-input,
        body.light-mode .location-input {
            background-color: rgba(255, 255, 255, 0.4);
            color: #333;
        }
        
        body.light-mode .bottom-nav-item,
        body.light-mode .settings-btn {
            color: #333;
        }
    </style>
    
    <script>
        // Default shortcuts with real favicon URLs
        const defaultShortcuts = [
            { name: 'YouTube', url: 'https://youtube.com', icon: 'https://www.youtube.com/favicon.ico' },
            { name: 'Gmail', url: 'https://mail.google.com', icon: 'https://ssl.gstatic.com/ui/v1/icons/mail/rfr/gmail.ico' },
            { name: 'Twitter', url: 'https://twitter.com', icon: 'https://twitter.com/favicon.ico' },
            { name: 'GitHub', url: 'https://github.com', icon: 'https://github.com/favicon.ico' },
            { name: 'Netflix', url: 'https://netflix.com', icon: 'https://assets.nflxext.com/us/ffe/siteui/common/icons/nficon2016.ico' },
            { name: 'Amazon', url: 'https://amazon.com', icon: 'https://www.amazon.com/favicon.ico' }
        ];
        
        // Load shortcuts from localStorage or use defaults
        function loadShortcuts() {
            const shortcuts = JSON.parse(localStorage.getItem('shortcuts')) || defaultShortcuts;
            const shortcutsContainer = document.getElementById('shortcuts');
            shortcutsContainer.innerHTML = '';
            
            shortcuts.forEach(shortcut => {
                const shortcutElement = document.createElement('a');
                shortcutElement.className = 'shortcut';
                shortcutElement.href = shortcut.url;
                
                // Use Google's favicon service as fallback if no icon provided
                const iconUrl = shortcut.icon || `https://www.google.com/s2/favicons?domain=${new URL(shortcut.url).hostname}&sz=64`;
                
                shortcutElement.innerHTML = `
                    <img src="${iconUrl}" alt="${shortcut.name}" onerror="this.src='https://www.google.com/s2/favicons?domain=${new URL(shortcut.url).hostname}&sz=64'">
                    <span>${shortcut.name}</span>
                `;
                
                shortcutsContainer.appendChild(shortcutElement);
            });
        }
        
        // Update clock and date
        function updateClock() {
            const now = new Date();
            const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };
            const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            
            document.getElementById('clock').textContent = now.toLocaleTimeString('de-DE', timeOptions);
            document.getElementById('date').textContent = now.toLocaleDateString('de-DE', dateOptions);
        }
        
        // Calculate moon phase (simple calculation)
        function getMoonPhase(date) {
            const year = date.getFullYear();
            const month = date.getMonth() + 1;
            const day = date.getDate();
            
            // Calculation of phase (0-29)
            // Approximation based on "Astronomical Algorithms" by Jean Meeus
            let r = year % 100;
            r %= 19;
            if (r > 9) r -= 19;
            r = ((r * 11) % 30) + month + day;
            if (month < 3) r += 2;
            r -= ((year < 2000) ? 4 : 8.3);
            r = Math.floor(r + 0.5) % 30;
            if (r < 0) r += 30;
            
            // Moon phase icon and text based on the phase
            let moonIcon, moonText;
            
            if (r < 1) {
                moonIcon = '🌑';
                moonText = 'Neumond';
            } else if (r < 7) {
                moonIcon = '🌒';
                moonText = 'Zunehmender Sichelmond';
            } else if (r < 8) {
                moonIcon = '🌓';
                moonText = 'Erstes Viertel';
            } else if (r < 14) {
                moonIcon = '🌔';
                moonText = 'Zunehmender Mond';
            } else if (r < 16) {
                moonIcon = '🌕';
                moonText = 'Vollmond';
            } else if (r < 22) {
                moonIcon = '🌖';
                moonText = 'Abnehmender Mond';
            } else if (r < 23) {
                moonIcon = '🌗';
                moonText = 'Letztes Viertel';
            } else {
                moonIcon = '🌘';
                moonText = 'Abnehmender Sichelmond';
            }
            
            return { icon: moonIcon, text: moonText };
        }
        
        // Weather API function
        async function getWeather(location) {
            try {
                // Using a CORS proxy to access the weather API
                const url = `https://api.openweathermap.org/data/2.5/weather?q=${location}&units=metric&lang=de&appid=9de243494c0b295cca9337e1e96b00e2`;
                const forecastUrl = `https://api.openweathermap.org/data/2.5/forecast?q=${location}&units=metric&lang=de&appid=9de243494c0b295cca9337e1e96b00e2`;
                
                // Get weather data
                const response = await fetch(url);
                const data = await response.json();
                
                // For forecast
                const forecastResponse = await fetch(forecastUrl);
                const forecastData = await forecastResponse.json();
                
                if (data.cod === 200) {
                    // Update UI with weather data
                    const temp = Math.round(data.main.temp);
                    const feelsLike = Math.round(data.main.feels_like);
                    const description = data.weather[0].description;
                    const humidity = data.main.humidity;
                    const windSpeed = Math.round(data.wind.speed * 3.6); // Convert to km/h
                    const pressure = data.main.pressure;
                    const visibility = (data.visibility / 1000).toFixed(1); // Convert to km
                    const clouds = data.clouds.all;
                    
                    // For sunrise and sunset
                    const sunrise = new Date(data.sys.sunrise * 1000);
                    const sunset = new Date(data.sys.sunset * 1000);
                    const sunriseTime = sunrise.toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });
                    const sunsetTime = sunset.toLocaleTimeString('de-DE', { hour: '2-digit', minute: '2-digit' });
                    
                    // Calculate dew point
                    const dewPoint = Math.round(temp - ((100 - humidity) / 5));
                    
                    // Get weather icon
                    let weatherIcon = '🌤️';
                    const weatherCode = data.weather[0].id;
                    
                    if (weatherCode < 300) {
                        weatherIcon = '⛈️'; // Thunderstorm
                    } else if (weatherCode < 400) {
                        weatherIcon = '🌧️'; // Drizzle
                    } else if (weatherCode < 600) {
                        weatherIcon = '🌧️'; // Rain
                    } else if (weatherCode < 700) {
                        weatherIcon = '❄️'; // Snow
                    } else if (weatherCode < 800) {
                        weatherIcon = '🌫️'; // Atmosphere (fog, mist, etc.)
                    } else if (weatherCode === 800) {
                        weatherIcon = '☀️'; // Clear sky
                    } else if (weatherCode < 900) {
                        weatherIcon = '☁️'; // Clouds
                    }
                    
                    // Update UI elements
                    document.querySelector('.weather-icon').textContent = weatherIcon;
                    document.querySelector('.weather-temp').textContent = `${temp}°C`;
                    document.querySelector('.weather-desc').textContent = description;
                    document.getElementById('feels-like').textContent = `${feelsLike}°C`;
                    document.getElementById('humidity').textContent = `${humidity}%`;
                    document.getElementById('wind').textContent = `${windSpeed} km/h`;
                    document.getElementById('pressure').textContent = `${pressure} hPa`;
                    document.getElementById('visibility').textContent = `${visibility} km`;
                    document.getElementById('clouds').textContent = `${clouds}%`;
                    document.getElementById('dew-point').textContent = `${dewPoint}°C`;
                    document.getElementById('sunrise').textContent = sunriseTime;
                    document.getElementById('sunset').textContent = sunsetTime;
                    
                    // Estimated UV index based on cloud coverage and time of day
                    let uvIndex = 0;
                    const hour = new Date().getHours();
                    const isSunUp = hour >= 7 && hour <= 19;
                    
                    if (isSunUp) {
                        const baseUV = 8; // Base UV value for sunshine
                        uvIndex = Math.round(baseUV * (1 - clouds / 100)); // Reduction based on cloud coverage
                    }
                    
                    document.getElementById('uv-index').textContent = uvIndex;
                    document.getElementById('uv-meter-value').style.width = `${(uvIndex / 11) * 100}%`;
                    
                    // Min/Max temperatures
                    if (forecastData.cod === '200') {
                        const today = new Date().setHours(0, 0, 0, 0);
                        const todayForecasts = forecastData.list.filter(item => {
                            const itemDate = new Date(item.dt * 1000).setHours(0, 0, 0, 0);
                            return itemDate === today;
                        });
                        
                        if (todayForecasts.length > 0) {
                            const temps = todayForecasts.map(item => item.main.temp);
                            const minTemp = Math.round(Math.min(...temps));
                            const maxTemp = Math.round(Math.max(...temps));
                            
                            document.getElementById('min-temp').textContent = `Min: ${minTemp}°C`;
                            document.getElementById('max-temp').textContent = `Max: ${maxTemp}°C`;
                        }
                        
                        // 5-day forecast
                        const forecastContainer = document.getElementById('forecast-container');
                        forecastContainer.innerHTML = '';
                        
                        // Group by days and take only one entry per day
                        const dailyForecasts = {};
                        forecastData.list.forEach(item => {
                            const date = new Date(item.dt * 1000);
                            const day = date.setHours(0, 0, 0, 0);
                            
                            if (!dailyForecasts[day] || date.getHours() === 12) {
                                dailyForecasts[day] = item;
                            }
                        });
                        
                        // Create elements for each day
                        Object.values(dailyForecasts).slice(0, 5).forEach(item => {
                            const date = new Date(item.dt * 1000);
                            const dayName = date.toLocaleDateString('de-DE', { weekday: 'short' });
                            
                            let forecastIcon = '🌤️';
                            const forecastCode = item.weather[0].id;
                            
                            if (forecastCode < 300) {
                                forecastIcon = '⛈️';
                            } else if (forecastCode < 400) {
                                forecastIcon = '🌧️';
                            } else if (forecastCode < 600) {
                                forecastIcon = '🌧️';
                            } else if (forecastCode < 700) {
                                forecastIcon = '❄️';
                            } else if (forecastCode < 800) {
                                forecastIcon = '🌫️';
                            } else if (forecastCode === 800) {
                                forecastIcon = '☀️';
                            } else if (forecastCode < 900) {
                                forecastIcon = '☁️';
                            }
                            
                            const forecastElement = document.createElement('div');
                            forecastElement.className = 'forecast-item';
                            forecastElement.innerHTML = `
                                <div class="forecast-day">${dayName}</div>
                                <div class="forecast-icon">${forecastIcon}</div>
                                <div class="forecast-temp">${Math.round(item.main.temp)}°C</div>
                            `;
                            
                            forecastContainer.appendChild(forecastElement);
                        });
                    }
                    
                    // Update moon phase
                    const moonPhase = getMoonPhase(new Date());
                    document.getElementById('moon-icon').textContent = moonPhase.icon;
                    document.getElementById('moon-phase').textContent = moonPhase.text;
                    
                    // Save location in localStorage
                    localStorage.setItem('weatherLocation', location);
                } else {
                    throw new Error('Stadt nicht gefunden');
                }
            } catch (error) {
                console.error('Fehler beim Abrufen der Wetterdaten:', error);
                document.querySelector('.weather-desc').textContent = 'Stadt nicht gefunden. Versuche es erneut.';
            }
        }
        
        // Get random quote
        function getQuote() {
            try {
                const quotes = [
                    "Der einzige Weg, großartige Arbeit zu leisten, ist zu lieben, was man tut.",
                    "Innovation unterscheidet den Anführer vom Nachfolger.",
                    "Deine Zeit ist begrenzt, also verschwende sie nicht damit, das Leben eines anderen zu leben.",
                    "Die Zukunft gehört denen, die an die Schönheit ihrer Träume glauben.",
                    "Das Leben ist das, was passiert, während du beschäftigt bist, andere Pläne zu machen.",
                    "Die Reise von tausend Meilen beginnt mit einem Schritt.",
                    "Einfachheit ist die ultimative Raffinesse.",
                    "Design ist nicht nur, wie es aussieht und sich anfühlt. Design ist, wie es funktioniert.",
                    "Bleib hungrig, bleib närrisch.",
                    "Denke anders."
                ];
                
                const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
                document.getElementById('quote').textContent = `"${randomQuote}"`;
            } catch (error) {
                console.error('Fehler beim Abrufen des Zitats:', error);
            }
        }
        
        // Weather tabs
        document.querySelectorAll('.weather-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                // Set active tab
                document.querySelectorAll('.weather-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Show active content
                const tabId = this.getAttribute('data-tab');
                document.querySelectorAll('.weather-content').forEach(content => content.classList.remove('active'));
                
                if (tabId === 'current') {
                    document.getElementById('current-weather').classList.add('active');
                } else if (tabId === 'details') {
                    document.getElementById('details-weather').classList.add('active');
                } else if (tabId === 'forecast') {
                    document.getElementById('forecast-weather').classList.add('active');
                }
            });
        });
        
        // Show/hide settings panel
        document.getElementById('settings-btn').addEventListener('click', function() {
            document.getElementById('settings-panel').classList.toggle('show');
        });
        
        // Add new shortcut
        document.getElementById('add-shortcut-btn').addEventListener('click', function() {
            const name = document.getElementById('shortcut-name').value.trim();
            let url = document.getElementById('shortcut-url').value.trim();
            const iconUrl = document.getElementById('shortcut-icon').value.trim();
            
            if (!name || !url) {
                alert('Bitte gib sowohl Namen als auch URL ein');
                return;
            }
            
            // Add https:// if not present
            if (!url.startsWith('http://') && !url.startsWith('https://')) {
                url = 'https://' + url;
            }
            
            // Get existing shortcuts
            const shortcuts = JSON.parse(localStorage.getItem('shortcuts')) || defaultShortcuts;
            
            // Add new shortcut
            shortcuts.push({
                name,
                url,
                icon: iconUrl || `https://www.google.com/s2/favicons?domain=${new URL(url).hostname}&sz=64` // Use Google's favicon service if none provided
            });
            
            // Save in localStorage
            localStorage.setItem('shortcuts', JSON.stringify(shortcuts));
            
            // Reload shortcuts
            loadShortcuts();
            
            // Clear input fields
            document.getElementById('shortcut-name').value = '';
            document.getElementById('shortcut-url').value = '';
            document.getElementById('shortcut-icon').value = '';
            
            // Hide settings panel
            document.getElementById('settings-panel').classList.remove('show');
        });
        
        // Weather location input
        document.getElementById('location-input').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const location = this.value.trim();
                if (location) {
                    getWeather(location);
                }
            }
        });
        
        // Function to check and handle most visited sites
        function loadTopSites() {
            // This is just a mockup since we can't access the actual browser API
            // In a real implementation, this would use browser.topSites API
            const topSitesContainer = document.getElementById('top-sites-container');
            if (!topSitesContainer) return;
            
            const mockTopSites = [
                { title: 'Google', url: 'https://google.com', favicon: 'https://www.google.com/favicon.ico' },
                { title: 'Facebook', url: 'https://facebook.com', favicon: 'https://static.xx.fbcdn.net/rsrc.php/yD/r/d4ZIVX-5C-b.ico' },
                { title: 'Amazon', url: 'https://amazon.com', favicon: 'https://www.amazon.com/favicon.ico' },
                { title: 'Wikipedia', url: 'https://wikipedia.org', favicon: 'https://en.wikipedia.org/static/favicon/wikipedia.ico' }
            ];
            
            topSitesContainer.innerHTML = '';
            mockTopSites.forEach(site => {
                const siteElement = document.createElement('a');
                siteElement.className = 'top-site-item';
                siteElement.href = site.url;
                siteElement.innerHTML = `
                    <img src="${site.favicon}" alt="${site.title}">
                    <span>${site.title}</span>
                `;
                topSitesContainer.appendChild(siteElement);
            });
        }
        
        // Function to toggle dark/light mode
        function toggleDarkMode() {
            const isDark = document.body.classList.toggle('light-mode');
            localStorage.setItem('lightMode', isDark ? 'false' : 'true');
        }
        
        // Function to open Firefox internal pages
        function openInternalPage(page) {
            try {
                // In a real extension, this would use browser.tabs.create
                // Here we'll use a fallback approach for demo purposes
                if (typeof browser !== 'undefined' && browser.tabs) {
                    browser.tabs.create({ url: page });
                } else if (typeof chrome !== 'undefined' && chrome.tabs) {
                    chrome.tabs.create({ url: page });
                } else {
                    window.location.href = page;
                }
            } catch (err) {
                console.error("Could not open internal page:", err);
                alert("Diese Funktion benötigt eine echte Firefox-Erweiterung.");
            }
        }

        // Function to handle browser theme changes
        function setBrowserTheme(theme) {
            localStorage.setItem('browserTheme', theme);
            const root = document.documentElement;
            
            if (theme === 'firefox') {
                root.style.setProperty('--accent-color', '#ff9500');
            } else if (theme === 'blue') {
                root.style.setProperty('--accent-color', '#0071e3');
            } else if (theme === 'green') {
                root.style.setProperty('--accent-color', '#28cd41');
            } else if (theme === 'purple') {
                root.style.setProperty('--accent-color', '#8A2BE2');
            }
        }
        
        // Initialization
        document.addEventListener('DOMContentLoaded', function() {
            // Load shortcuts
            loadShortcuts();
            
            // Update clock initially and then every second
            updateClock();
            setInterval(updateClock, 1000);
            
            // Load weather
            const savedLocation = localStorage.getItem('weatherLocation') || 'Berlin';
            document.getElementById('location-input').value = savedLocation;
            getWeather(savedLocation);
            
            // Load random quote
            getQuote();
            
            // Load top sites
            loadTopSites();
            
            // Set theme from localStorage
            const savedTheme = localStorage.getItem('browserTheme') || 'firefox';
            setBrowserTheme(savedTheme);
            
            // Check for light/dark mode preference
            if (localStorage.getItem('lightMode') === 'true') {
                document.body.classList.add('light-mode');
            }
            
            // Set up Firefox internal page buttons
            document.getElementById('bookmarks-button').addEventListener('click', function(e) {
                e.preventDefault();
                openInternalPage('about:bookmarks');
            });
            
            document.getElementById('downloads-button').addEventListener('click', function(e) {
                e.preventDefault();
                openInternalPage('about:downloads');
            });
            
            document.getElementById('history-button').addEventListener('click', function(e) {
                e.preventDefault();
                openInternalPage('about:history');
            });
            
            document.getElementById('addons-button').addEventListener('click', function(e) {
                e.preventDefault();
                openInternalPage('about:addons');
            });
        });
    </script>
</body>
</html>
